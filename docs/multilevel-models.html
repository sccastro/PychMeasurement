<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Multilevel Models | Psychological Measurement in R</title>
  <meta name="description" content="As a modern Psychologist, we can no longer be purely theoretical hypothesis generators, experimentalists, statisticians, or clinicians; now we must strive to be methodologically sound, balance experimental design against convenient populations, keep up with the ever-changing landscape of statistical tests and their caveats, and learn rudimentary computer programming on top of that! Therefore we need a tool that balances the comprehensibility of human language with the flexibility to keep up with developing statistical methods and the power to analyze any dataset. Enter R, the open-source statistical computing and graphics language with a powerful Integrated Development Environment (the Rstudio IDE), a robust community of developers, data scientists, and experts (who respond to questions!), and too many reputable online resources to read in a lifetime. The impetus to learn something new on top of your ongoing research may be hard to summon, but this course is designed to integrate your ongoing research projects into mastering R, and to provide tools for streamlining projects in the future." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Multilevel Models | Psychological Measurement in R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://spencercastro.com" />
  <meta property="og:image" content="https://spencercastro.comimages/UPsychLogo.jpg" />
  <meta property="og:description" content="As a modern Psychologist, we can no longer be purely theoretical hypothesis generators, experimentalists, statisticians, or clinicians; now we must strive to be methodologically sound, balance experimental design against convenient populations, keep up with the ever-changing landscape of statistical tests and their caveats, and learn rudimentary computer programming on top of that! Therefore we need a tool that balances the comprehensibility of human language with the flexibility to keep up with developing statistical methods and the power to analyze any dataset. Enter R, the open-source statistical computing and graphics language with a powerful Integrated Development Environment (the Rstudio IDE), a robust community of developers, data scientists, and experts (who respond to questions!), and too many reputable online resources to read in a lifetime. The impetus to learn something new on top of your ongoing research may be hard to summon, but this course is designed to integrate your ongoing research projects into mastering R, and to provide tools for streamlining projects in the future." />
  <meta name="github-repo" content="sccastro/PsychMeasurement" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Multilevel Models | Psychological Measurement in R" />
  
  <meta name="twitter:description" content="As a modern Psychologist, we can no longer be purely theoretical hypothesis generators, experimentalists, statisticians, or clinicians; now we must strive to be methodologically sound, balance experimental design against convenient populations, keep up with the ever-changing landscape of statistical tests and their caveats, and learn rudimentary computer programming on top of that! Therefore we need a tool that balances the comprehensibility of human language with the flexibility to keep up with developing statistical methods and the power to analyze any dataset. Enter R, the open-source statistical computing and graphics language with a powerful Integrated Development Environment (the Rstudio IDE), a robust community of developers, data scientists, and experts (who respond to questions!), and too many reputable online resources to read in a lifetime. The impetus to learn something new on top of your ongoing research may be hard to summon, but this course is designed to integrate your ongoing research projects into mastering R, and to provide tools for streamlining projects in the future." />
  <meta name="twitter:image" content="https://spencercastro.comimages/UPsychLogo.jpg" />

<meta name="author" content="Spencer Castro" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-models.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="class_book.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Psychological Measurement in R</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="syllabus.html"><a href="syllabus.html"><i class="fa fa-check"></i><b>1</b> Syllabus</a><ul>
<li class="chapter" data-level="1.1" data-path="syllabus.html"><a href="syllabus.html#course-overview"><i class="fa fa-check"></i><b>1.1</b> Course Overview</a></li>
<li class="chapter" data-level="1.2" data-path="syllabus.html"><a href="syllabus.html#learning-outcomes-course-objectives"><i class="fa fa-check"></i><b>1.2</b> Learning Outcomes &amp; Course Objectives</a></li>
<li class="chapter" data-level="1.3" data-path="syllabus.html"><a href="syllabus.html#course-format"><i class="fa fa-check"></i><b>1.3</b> Course Format</a></li>
<li class="chapter" data-level="1.4" data-path="syllabus.html"><a href="syllabus.html#evaluation-methodsassignments"><i class="fa fa-check"></i><b>1.4</b> Evaluation Methods/Assignments</a></li>
<li class="chapter" data-level="1.5" data-path="syllabus.html"><a href="syllabus.html#grading-policy"><i class="fa fa-check"></i><b>1.5</b> Grading Policy</a></li>
<li class="chapter" data-level="1.6" data-path="syllabus.html"><a href="syllabus.html#student-rights-and-responsibilities"><i class="fa fa-check"></i><b>1.6</b> Student Rights and Responsibilities</a></li>
<li class="chapter" data-level="1.7" data-path="syllabus.html"><a href="syllabus.html#department-of-psychology-undergraduate-academic-misconduct-policy"><i class="fa fa-check"></i><b>1.7</b> Department of Psychology Undergraduate Academic Misconduct Policy</a></li>
<li class="chapter" data-level="1.8" data-path="syllabus.html"><a href="syllabus.html#course-policies"><i class="fa fa-check"></i><b>1.8</b> Course Policies</a></li>
<li class="chapter" data-level="1.9" data-path="syllabus.html"><a href="syllabus.html#university-attendance-requirements"><i class="fa fa-check"></i><b>1.9</b> University Attendance Requirements</a></li>
<li class="chapter" data-level="1.10" data-path="syllabus.html"><a href="syllabus.html#student-support-accommodations"><i class="fa fa-check"></i><b>1.10</b> Student Support &amp; Accommodations</a></li>
<li class="chapter" data-level="1.11" data-path="syllabus.html"><a href="syllabus.html#academic-calendar"><i class="fa fa-check"></i><b>1.11</b> Academic Calendar</a></li>
<li class="chapter" data-level="1.12" data-path="syllabus.html"><a href="syllabus.html#course-schedule"><i class="fa fa-check"></i><b>1.12</b> Course Schedule</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#baser-walkthrough"><i class="fa fa-check"></i>BaseR walkthrough</a></li>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#help"><i class="fa fa-check"></i><b>2.1</b> Help</a></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#vectors"><i class="fa fa-check"></i><b>2.2</b> VECTORS</a></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#programming"><i class="fa fa-check"></i><b>2.3</b> PROGRAMMING</a><ul>
<li class="chapter" data-level="2.3.1" data-path="introduction.html"><a href="introduction.html#for-loop"><i class="fa fa-check"></i><b>2.3.1</b> For loop</a></li>
<li class="chapter" data-level="2.3.2" data-path="introduction.html"><a href="introduction.html#while-loop"><i class="fa fa-check"></i><b>2.3.2</b> While loop</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="introduction.html"><a href="introduction.html#assignment-1"><i class="fa fa-check"></i><b>2.4</b> Assignment 1</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i><b>3</b> Importing Data</a><ul>
<li class="chapter" data-level="" data-path="importing-data.html"><a href="importing-data.html#reading-files-into-r"><i class="fa fa-check"></i>Reading files into R</a></li>
<li class="chapter" data-level="3.1" data-path="importing-data.html"><a href="importing-data.html#whats-a-tibble"><i class="fa fa-check"></i><b>3.1</b> What’s a tibble?</a></li>
<li class="chapter" data-level="3.2" data-path="importing-data.html"><a href="importing-data.html#save-your-dataset"><i class="fa fa-check"></i><b>3.2</b> Save your dataset:</a></li>
<li class="chapter" data-level="3.3" data-path="importing-data.html"><a href="importing-data.html#cleaning-your-data-file"><i class="fa fa-check"></i><b>3.3</b> Cleaning your data file</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>4</b> Data Transformation</a><ul>
<li class="chapter" data-level="" data-path="data-transformation.html"><a href="data-transformation.html#data-transformation-with-dplyr"><i class="fa fa-check"></i>Data Transformation with Dplyr</a></li>
<li class="chapter" data-level="4.1" data-path="data-transformation.html"><a href="data-transformation.html#get-a-dataset-from-your-.rdata-file"><i class="fa fa-check"></i><b>4.1</b> Get a dataset from your .RData file</a></li>
<li class="chapter" data-level="4.2" data-path="data-transformation.html"><a href="data-transformation.html#introduction-to-the-pipe"><i class="fa fa-check"></i><b>4.2</b> Introduction to “The Pipe”</a></li>
<li class="chapter" data-level="4.3" data-path="data-transformation.html"><a href="data-transformation.html#aside-on-the-apply-family"><i class="fa fa-check"></i><b>4.3</b> Aside on the apply family</a></li>
<li class="chapter" data-level="4.4" data-path="data-transformation.html"><a href="data-transformation.html#solutions-to-challenges"><i class="fa fa-check"></i><b>4.4</b> Solutions to Challenges</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-transformation-day-2.html"><a href="data-transformation-day-2.html"><i class="fa fa-check"></i><b>5</b> Data Transformation Day 2</a><ul>
<li class="chapter" data-level="5.1" data-path="data-transformation-day-2.html"><a href="data-transformation-day-2.html#rcolorbrewer"><i class="fa fa-check"></i><b>5.1</b> RcolorBrewer</a></li>
<li class="chapter" data-level="5.2" data-path="data-transformation-day-2.html"><a href="data-transformation-day-2.html#modifying-factor-levels"><i class="fa fa-check"></i><b>5.2</b> Modifying Factor Levels</a></li>
<li class="chapter" data-level="5.3" data-path="data-transformation-day-2.html"><a href="data-transformation-day-2.html#play-time"><i class="fa fa-check"></i><b>5.3</b> Play time</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="visualization-with-ggplot2.html"><a href="visualization-with-ggplot2.html"><i class="fa fa-check"></i><b>6</b> Visualization with ggplot2</a><ul>
<li class="chapter" data-level="6.1" data-path="visualization-with-ggplot2.html"><a href="visualization-with-ggplot2.html#statistical-transformations"><i class="fa fa-check"></i><b>6.1</b> Statistical Transformations</a></li>
<li class="chapter" data-level="6.2" data-path="visualization-with-ggplot2.html"><a href="visualization-with-ggplot2.html#changing-the-position"><i class="fa fa-check"></i><b>6.2</b> Changing the position</a></li>
<li class="chapter" data-level="6.3" data-path="visualization-with-ggplot2.html"><a href="visualization-with-ggplot2.html#coordinates"><i class="fa fa-check"></i><b>6.3</b> Coordinates</a><ul>
<li class="chapter" data-level="6.3.1" data-path="visualization-with-ggplot2.html"><a href="visualization-with-ggplot2.html#plot-maps-if-you-want"><i class="fa fa-check"></i><b>6.3.1</b> Plot maps if you want</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html"><i class="fa fa-check"></i><b>7</b> Introduction to Statistics</a><ul>
<li class="chapter" data-level="7.0.1" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#descriptive-stats"><i class="fa fa-check"></i><b>7.0.1</b> Descriptive Stats</a></li>
<li class="chapter" data-level="7.0.2" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>7.0.2</b> Measures of Central Tendency</a></li>
<li class="chapter" data-level="7.0.3" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#measures-of-variability"><i class="fa fa-check"></i><b>7.0.3</b> Measures of Variability</a></li>
<li class="chapter" data-level="7.1" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#clinical-trial-example"><i class="fa fa-check"></i><b>7.1</b> Clinical Trial Example</a><ul>
<li class="chapter" data-level="7.1.1" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#chi-square-goodness-of-fit-test-pearson-1900-review"><i class="fa fa-check"></i><b>7.1.1</b> Chi Square goodness-of-fit test (Pearson, 1900) Review</a></li>
<li class="chapter" data-level="7.1.2" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#chi-square-test-of-independence"><i class="fa fa-check"></i><b>7.1.2</b> Chi-square test of independence</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>8</b> Linear Models</a><ul>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#steps-of-linear-models"><i class="fa fa-check"></i>Steps of Linear Models</a></li>
<li class="chapter" data-level="8.1" data-path="linear-models.html"><a href="linear-models.html#step-1.-get-your-data"><i class="fa fa-check"></i><b>8.1</b> Step 1. Get your data</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="multilevel-models.html"><a href="multilevel-models.html"><i class="fa fa-check"></i><b>9</b> Multilevel Models</a><ul>
<li class="chapter" data-level="" data-path="multilevel-models.html"><a href="multilevel-models.html#steps-of-multilevel-models"><i class="fa fa-check"></i>Steps of Multilevel Models</a><ul>
<li class="chapter" data-level="9.0.1" data-path="multilevel-models.html"><a href="multilevel-models.html#mixed-models-in-r"><i class="fa fa-check"></i><b>9.0.1</b> Mixed models in R</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Psychological Measurement in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multilevel-models" class="section level1">
<h1><span class="header-section-number">9</span> Multilevel Models</h1>
<blockquote>
“When we go to run our stats and test our hypotheses about the world, what if we didn’t assume everyone was the same?”
<div style="text-align: right">
— Ty Mckinney
</div>
</blockquote>
<blockquote>
“The Earth is round (p &lt; .05).”
<div style="text-align: right">
— Jacob Cohen
</div>
</blockquote>
<p>First off…</p>
<h4>
Advanced R Challenges
</h4>
<p>APPLY A “MIXED EFFECTS” MODEL TO YOUR DATASET (if it doesn’t make sense with your data, find a dataset for within and between variables in “datasets”)</p>
<div id="steps-of-multilevel-models" class="section level2 unnumbered">
<h2>Steps of Multilevel Models</h2>
<p>##Step 1. Get your data</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb221-1" data-line-number="1"><span class="kw">require</span>(tidyverse)</a>
<a class="sourceLine" id="cb221-2" data-line-number="2"><span class="co">#&gt; Loading required package: tidyverse</span></a>
<a class="sourceLine" id="cb221-3" data-line-number="3"><span class="co">#&gt; ── Attaching packages ────────────────────────────────────────────────────────────────────── tidyverse 1.3.0 ──</span></a>
<a class="sourceLine" id="cb221-4" data-line-number="4"><span class="co">#&gt; ✔ ggplot2 3.2.1     ✔ purrr   0.3.3</span></a>
<a class="sourceLine" id="cb221-5" data-line-number="5"><span class="co">#&gt; ✔ tibble  2.1.3     ✔ dplyr   0.8.3</span></a>
<a class="sourceLine" id="cb221-6" data-line-number="6"><span class="co">#&gt; ✔ tidyr   1.0.0     ✔ stringr 1.4.0</span></a>
<a class="sourceLine" id="cb221-7" data-line-number="7"><span class="co">#&gt; ✔ readr   1.3.1     ✔ forcats 0.4.0</span></a>
<a class="sourceLine" id="cb221-8" data-line-number="8"><span class="co">#&gt; ── Conflicts ───────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──</span></a>
<a class="sourceLine" id="cb221-9" data-line-number="9"><span class="co">#&gt; ✖ dplyr::filter() masks stats::filter()</span></a>
<a class="sourceLine" id="cb221-10" data-line-number="10"><span class="co">#&gt; ✖ dplyr::lag()    masks stats::lag()</span></a>
<a class="sourceLine" id="cb221-11" data-line-number="11"></a>
<a class="sourceLine" id="cb221-12" data-line-number="12">df &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;~/Dropbox/RCOURSE/books_resources/politeness_data.csv&quot;</span>)</a>
<a class="sourceLine" id="cb221-13" data-line-number="13"><span class="co">#&gt; Parsed with column specification:</span></a>
<a class="sourceLine" id="cb221-14" data-line-number="14"><span class="co">#&gt; cols(</span></a>
<a class="sourceLine" id="cb221-15" data-line-number="15"><span class="co">#&gt;   subject = col_character(),</span></a>
<a class="sourceLine" id="cb221-16" data-line-number="16"><span class="co">#&gt;   gender = col_character(),</span></a>
<a class="sourceLine" id="cb221-17" data-line-number="17"><span class="co">#&gt;   scenario = col_double(),</span></a>
<a class="sourceLine" id="cb221-18" data-line-number="18"><span class="co">#&gt;   attitude = col_character(),</span></a>
<a class="sourceLine" id="cb221-19" data-line-number="19"><span class="co">#&gt;   frequency = col_double()</span></a>
<a class="sourceLine" id="cb221-20" data-line-number="20"><span class="co">#&gt; )</span></a></code></pre></div>
<p>In our study, politeness is treated as a categorical factor with two levels… a formal register and an informal register. On top of that, we also had an additional fixed effect, sex, and so our formula looks more like this:</p>
<p><span class="math display">\[ pitch \sim politeness + sex + ε \]</span></p>
<p>So far so good. Now things get a little more complicated. Our design was so that we took multiple measures per subject. That is, each subject gave multiple polite responses and multiple informal responses. If we go back to the discussion of the assumptions of the linear model in Chapter 7, we can immediately see that this would violate the independence assumption: Multiple responses from the same subject cannot be regarded as independent from each other. Every person has a slightly different voice pitch, and this is going to be an idiosyncratic factor that affects all responses from the same subject, thus rendering these different responses inter-dependent rather than independent.</p>
<p>The way we’re going to deal with this situation is to add a random effect for
subject. This allows us to resolve this non-independence by assuming a different
“baseline” pitch value for each subject. So, subject 1 may have a mean voice pitch
of 233 Hz across different utterances, and subject 2 may have a mean voice pitch
of 210 Hz per subject. Here’s a visual depiction of how this looks like:</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb222-1" data-line-number="1">df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb222-2" data-line-number="2"><span class="st">  </span><span class="kw">na.omit</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb222-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(subject,scenario, attitude) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb222-4" data-line-number="4"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mfreq =</span> <span class="kw">mean</span>(frequency)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb222-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> subject, <span class="dt">y =</span> mfreq)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="08_MultilevelModels_files/figure-html/interdependence-1.png" width="70%" style="display: block; margin: auto;" />
We can model these individual differences by assuming different random
intercepts for each subject. That is, each subject is assigned a different intercept
value, and the mixed model estimates these intercepts for you.</p>
<p>Now you begin to see why the mixed model is called a “mixed” model. The linear
models that we considered so far have been “fixed-effects-only” models that had
one or more fixed effects and a general error term “ε”. With the linear model, we
essentially divided the world into things that we somehow understand or that are
somehow systematic (the fixed effects, or the explanatory variables); and things
that we cannot control for or that we don’t understand (ε). But crucially, this latter
part, the unsystematic part of the model, did not have any interesting structure.
We simply had a general across-the-board error term.
In the mixed model, we add one or more random effects to our fixed effects.
These random effects essentially give structure to the error term “ε”. In the case of
our model here, we add a random effect for “subject”, and this characterizes
idiosyncratic variation that is due to individual differences.
The mixture of fixed and random effects is what makes the mixed model a mixed
model.</p>
<p>Our updated formula looks like this:</p>
<p><span class="math display">\[ pitch \sim politeness + sex + (1|subject) + ε \]</span></p>
<p>“(1|subject)” looks a little enigmatic. I’m already using the R-typical notation format here. What this is saying is “assume an intercept that’s different for each subject” … and “1” stands for the intercept here. You can think of this formula as telling your model that it should expect that there’s going to be multiple responses per subject, and these responses will depend on each subject’s baseline level. This effectively resolves the non-independence that stems from having multiple responses by the same subject.</p>
<p>Subjects also had to imagine asking a professor for a favor (polite condition), or asking a peer for a favor (informal condition). An example of a scenario was: item was an “excusing for coming too late” scenario, which was similarly divided between polite and informal. In total, there were 7 such different items.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb223-1" data-line-number="1">df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb223-2" data-line-number="2"><span class="st">  </span><span class="kw">na.omit</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb223-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(subject,scenario, attitude) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb223-4" data-line-number="4"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mfreq =</span> <span class="kw">mean</span>(frequency)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb223-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> scenario, <span class="dt">y =</span> mfreq, <span class="dt">group =</span> scenario)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()</a>
<a class="sourceLine" id="cb223-6" data-line-number="6"></a>
<a class="sourceLine" id="cb223-7" data-line-number="7"></a>
<a class="sourceLine" id="cb223-8" data-line-number="8"></a>
<a class="sourceLine" id="cb223-9" data-line-number="9"></a>
<a class="sourceLine" id="cb223-10" data-line-number="10"><span class="co"># Challenge 1 -------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb223-11" data-line-number="11"> </a>
<a class="sourceLine" id="cb223-12" data-line-number="12"><span class="co"># What happens if we leave out the &quot;group&quot; argument to aes()?</span></a>
<a class="sourceLine" id="cb223-13" data-line-number="13"><span class="co"># Why?</span></a>
<a class="sourceLine" id="cb223-14" data-line-number="14"></a>
<a class="sourceLine" id="cb223-15" data-line-number="15"></a>
<a class="sourceLine" id="cb223-16" data-line-number="16"><span class="co"># How do we account for variation in scenario?</span></a></code></pre></div>
<p><img src="08_MultilevelModels_files/figure-html/unnamed-chunk-2-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>We do this by adding an additional random effect:</p>
<p><span class="math display">\[ pitch \sim politeness + sex + (1|subject) + (1|item) + ε \]</span></p>
<div id="mixed-models-in-r" class="section level3">
<h3><span class="header-section-number">9.0.1</span> Mixed models in R</h3>
<p>####Step 2.
For a start, we need to install the R package lme4 (Bates, Maechler &amp; Bolker, 2012).
open R and type in:</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb224-1" data-line-number="1"><span class="co"># install.packages(&quot;lme4&quot;)</span></a></code></pre></div>
<p>After installation, load the lme4 package into R with
the following command:</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb225-1" data-line-number="1"><span class="kw">library</span>(lme4)</a></code></pre></div>
<p>Now, you have the function <code>lmer()</code> available to you, which is the mixed model equivalent of the function <code>lm()</code> in tutorial 1. This function is going to construct mixed models for us.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb226-1" data-line-number="1">politeness.model =<span class="st"> </span><span class="kw">lmer</span>(frequency <span class="op">~</span><span class="st"> </span>attitude <span class="op">+</span></a>
<a class="sourceLine" id="cb226-2" data-line-number="2"><span class="st">                          </span>(<span class="dv">1</span><span class="op">|</span>subject) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>scenario), <span class="dt">data=</span>df)</a>
<a class="sourceLine" id="cb226-3" data-line-number="3"></a>
<a class="sourceLine" id="cb226-4" data-line-number="4"></a>
<a class="sourceLine" id="cb226-5" data-line-number="5"><span class="kw">summary</span>(politeness.model)</a>
<a class="sourceLine" id="cb226-6" data-line-number="6"><span class="co">#&gt; Linear mixed model fit by REML [&#39;lmerMod&#39;]</span></a>
<a class="sourceLine" id="cb226-7" data-line-number="7"><span class="co">#&gt; Formula: frequency ~ attitude + (1 | subject) + (1 | scenario)</span></a>
<a class="sourceLine" id="cb226-8" data-line-number="8"><span class="co">#&gt;    Data: df</span></a>
<a class="sourceLine" id="cb226-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb226-10" data-line-number="10"><span class="co">#&gt; REML criterion at convergence: 794</span></a>
<a class="sourceLine" id="cb226-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb226-12" data-line-number="12"><span class="co">#&gt; Scaled residuals: </span></a>
<a class="sourceLine" id="cb226-13" data-line-number="13"><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></a>
<a class="sourceLine" id="cb226-14" data-line-number="14"><span class="co">#&gt; -2.201 -0.582 -0.064  0.563  3.439 </span></a>
<a class="sourceLine" id="cb226-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb226-16" data-line-number="16"><span class="co">#&gt; Random effects:</span></a>
<a class="sourceLine" id="cb226-17" data-line-number="17"><span class="co">#&gt;  Groups   Name        Variance Std.Dev.</span></a>
<a class="sourceLine" id="cb226-18" data-line-number="18"><span class="co">#&gt;  scenario (Intercept)  219     14.8    </span></a>
<a class="sourceLine" id="cb226-19" data-line-number="19"><span class="co">#&gt;  subject  (Intercept) 4015     63.4    </span></a>
<a class="sourceLine" id="cb226-20" data-line-number="20"><span class="co">#&gt;  Residual              646     25.4    </span></a>
<a class="sourceLine" id="cb226-21" data-line-number="21"><span class="co">#&gt; Number of obs: 83, groups:  scenario, 7; subject, 6</span></a>
<a class="sourceLine" id="cb226-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb226-23" data-line-number="23"><span class="co">#&gt; Fixed effects:</span></a>
<a class="sourceLine" id="cb226-24" data-line-number="24"><span class="co">#&gt;             Estimate Std. Error t value</span></a>
<a class="sourceLine" id="cb226-25" data-line-number="25"><span class="co">#&gt; (Intercept)   202.59      26.75    7.57</span></a>
<a class="sourceLine" id="cb226-26" data-line-number="26"><span class="co">#&gt; attitudepol   -19.69       5.58   -3.53</span></a>
<a class="sourceLine" id="cb226-27" data-line-number="27"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb226-28" data-line-number="28"><span class="co">#&gt; Correlation of Fixed Effects:</span></a>
<a class="sourceLine" id="cb226-29" data-line-number="29"><span class="co">#&gt;             (Intr)</span></a>
<a class="sourceLine" id="cb226-30" data-line-number="30"><span class="co">#&gt; attitudepol -0.103</span></a>
<a class="sourceLine" id="cb226-31" data-line-number="31"></a>
<a class="sourceLine" id="cb226-32" data-line-number="32"><span class="kw">coef</span>(politeness.model)</a>
<a class="sourceLine" id="cb226-33" data-line-number="33"><span class="co">#&gt; $scenario</span></a>
<a class="sourceLine" id="cb226-34" data-line-number="34"><span class="co">#&gt;   (Intercept) attitudepol</span></a>
<a class="sourceLine" id="cb226-35" data-line-number="35"><span class="co">#&gt; 1         189       -19.7</span></a>
<a class="sourceLine" id="cb226-36" data-line-number="36"><span class="co">#&gt; 2         209       -19.7</span></a>
<a class="sourceLine" id="cb226-37" data-line-number="37"><span class="co">#&gt; 3         214       -19.7</span></a>
<a class="sourceLine" id="cb226-38" data-line-number="38"><span class="co">#&gt; 4         223       -19.7</span></a>
<a class="sourceLine" id="cb226-39" data-line-number="39"><span class="co">#&gt; 5         201       -19.7</span></a>
<a class="sourceLine" id="cb226-40" data-line-number="40"><span class="co">#&gt; 6         190       -19.7</span></a>
<a class="sourceLine" id="cb226-41" data-line-number="41"><span class="co">#&gt; 7         192       -19.7</span></a>
<a class="sourceLine" id="cb226-42" data-line-number="42"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb226-43" data-line-number="43"><span class="co">#&gt; $subject</span></a>
<a class="sourceLine" id="cb226-44" data-line-number="44"><span class="co">#&gt;    (Intercept) attitudepol</span></a>
<a class="sourceLine" id="cb226-45" data-line-number="45"><span class="co">#&gt; F1         241       -19.7</span></a>
<a class="sourceLine" id="cb226-46" data-line-number="46"><span class="co">#&gt; F2         267       -19.7</span></a>
<a class="sourceLine" id="cb226-47" data-line-number="47"><span class="co">#&gt; F3         260       -19.7</span></a>
<a class="sourceLine" id="cb226-48" data-line-number="48"><span class="co">#&gt; M3         179       -19.7</span></a>
<a class="sourceLine" id="cb226-49" data-line-number="49"><span class="co">#&gt; M4         155       -19.7</span></a>
<a class="sourceLine" id="cb226-50" data-line-number="50"><span class="co">#&gt; M7         113       -19.7</span></a>
<a class="sourceLine" id="cb226-51" data-line-number="51"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb226-52" data-line-number="52"><span class="co">#&gt; attr(,&quot;class&quot;)</span></a>
<a class="sourceLine" id="cb226-53" data-line-number="53"><span class="co">#&gt; [1] &quot;coef.mer&quot;</span></a></code></pre></div>
<p>Let’s focus on the output for the random effects first:</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb227-1" data-line-number="1"><span class="co"># Random effects:</span></a>
<a class="sourceLine" id="cb227-2" data-line-number="2"><span class="co">#   Groups   Name       Variance Std.Dev.</span></a>
<a class="sourceLine" id="cb227-3" data-line-number="3"><span class="co"># scenario (Intercept)  219     14.80   </span></a>
<a class="sourceLine" id="cb227-4" data-line-number="4"><span class="co"># subject  (Intercept) 4015     63.36   </span></a>
<a class="sourceLine" id="cb227-5" data-line-number="5"><span class="co"># Residual              646     25.42   </span></a>
<a class="sourceLine" id="cb227-6" data-line-number="6"><span class="co"># Number of obs: 83, groups:  scenario, 7; subject, 6</span></a></code></pre></div>
<p>Have a look at the column standard deviation. This is a measure of how much variability in the dependent measure there is due to scenarios and subjects (our
two random effects). You can see that scenario (“item”) has much less variability than subject. Based on our boxplots from above, where we saw more idiosyncratic differences between subjects than between items, this is to be expected. Then, you see “Residual” which stands for the variability that’s not due to either scenario or subject. This is our “ε” again, the “random” deviations from the predicted values that are not due to subjects and items. Here, this reflects the fact that each and every utterance has some factors that affect pitch that are outside of the purview of our experiment.</p>
<p>The fixed effects output mirrors the coefficient table that we considered in tutorial 1 when we talked about the results of our linear model analysis.</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb228-1" data-line-number="1"><span class="co"># Fixed effects:</span></a>
<a class="sourceLine" id="cb228-2" data-line-number="2"><span class="co">#              Estimate  Std. Error t value</span></a>
<a class="sourceLine" id="cb228-3" data-line-number="3"><span class="co"># (Intercept)  202.588     26.754   7.572</span></a>
<a class="sourceLine" id="cb228-4" data-line-number="4"><span class="co"># attitudepol  -19.695      5.585  -3.527</span></a></code></pre></div>
<p>The coefficient “attitudepol” is the slope for the categorical effect of politeness. Minus 19.695 means that to go from “informal” to “polite”, you have to go down-19.695 Hz. In other words: pitch is lower in polite speech than in informal speech,by about 20 Hz. Then, there’s a standard error associated with this slope, and a tvalue, which is simply the estimate (20 Hz) divided by the standard error (check this by performing the calculation by hand).</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb229-1" data-line-number="1"><span class="co"># Challenge 2 -------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb229-2" data-line-number="2"></a>
<a class="sourceLine" id="cb229-3" data-line-number="3"><span class="co"># this intercept is especially weird. </span></a>
<a class="sourceLine" id="cb229-4" data-line-number="4"><span class="co"># It’s 202.588 Hz … where does that value come</span></a>
<a class="sourceLine" id="cb229-5" data-line-number="5"><span class="co"># from?</span></a>
<a class="sourceLine" id="cb229-6" data-line-number="6"></a>
<a class="sourceLine" id="cb229-7" data-line-number="7"></a>
<a class="sourceLine" id="cb229-8" data-line-number="8"></a>
<a class="sourceLine" id="cb229-9" data-line-number="9">politeness.model =<span class="st"> </span><span class="kw">lmer</span>(frequency <span class="op">~</span><span class="st"> </span>attitude <span class="op">*</span></a>
<a class="sourceLine" id="cb229-10" data-line-number="10"><span class="st">                          </span>gender <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>subject) <span class="op">+</span></a>
<a class="sourceLine" id="cb229-11" data-line-number="11"><span class="st">                          </span>(<span class="dv">1</span><span class="op">|</span>scenario), <span class="dt">data=</span>df)</a>
<a class="sourceLine" id="cb229-12" data-line-number="12"></a>
<a class="sourceLine" id="cb229-13" data-line-number="13"><span class="kw">summary</span>(politeness.model)</a>
<a class="sourceLine" id="cb229-14" data-line-number="14"><span class="co">#&gt; Linear mixed model fit by REML [&#39;lmerMod&#39;]</span></a>
<a class="sourceLine" id="cb229-15" data-line-number="15"><span class="co">#&gt; Formula: frequency ~ attitude * gender + (1 | subject) + (1 | scenario)</span></a>
<a class="sourceLine" id="cb229-16" data-line-number="16"><span class="co">#&gt;    Data: df</span></a>
<a class="sourceLine" id="cb229-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb229-18" data-line-number="18"><span class="co">#&gt; REML criterion at convergence: 767</span></a>
<a class="sourceLine" id="cb229-19" data-line-number="19"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb229-20" data-line-number="20"><span class="co">#&gt; Scaled residuals: </span></a>
<a class="sourceLine" id="cb229-21" data-line-number="21"><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></a>
<a class="sourceLine" id="cb229-22" data-line-number="22"><span class="co">#&gt; -2.119 -0.560 -0.077  0.511  3.335 </span></a>
<a class="sourceLine" id="cb229-23" data-line-number="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb229-24" data-line-number="24"><span class="co">#&gt; Random effects:</span></a>
<a class="sourceLine" id="cb229-25" data-line-number="25"><span class="co">#&gt;  Groups   Name        Variance Std.Dev.</span></a>
<a class="sourceLine" id="cb229-26" data-line-number="26"><span class="co">#&gt;  scenario (Intercept) 218      14.8    </span></a>
<a class="sourceLine" id="cb229-27" data-line-number="27"><span class="co">#&gt;  subject  (Intercept) 617      24.8    </span></a>
<a class="sourceLine" id="cb229-28" data-line-number="28"><span class="co">#&gt;  Residual             637      25.2    </span></a>
<a class="sourceLine" id="cb229-29" data-line-number="29"><span class="co">#&gt; Number of obs: 83, groups:  scenario, 7; subject, 6</span></a>
<a class="sourceLine" id="cb229-30" data-line-number="30"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb229-31" data-line-number="31"><span class="co">#&gt; Fixed effects:</span></a>
<a class="sourceLine" id="cb229-32" data-line-number="32"><span class="co">#&gt;                     Estimate Std. Error t value</span></a>
<a class="sourceLine" id="cb229-33" data-line-number="33"><span class="co">#&gt; (Intercept)           260.69      16.35   15.95</span></a>
<a class="sourceLine" id="cb229-34" data-line-number="34"><span class="co">#&gt; attitudepol           -27.40       7.79   -3.52</span></a>
<a class="sourceLine" id="cb229-35" data-line-number="35"><span class="co">#&gt; genderM              -116.20      21.73   -5.35</span></a>
<a class="sourceLine" id="cb229-36" data-line-number="36"><span class="co">#&gt; attitudepol:genderM    15.57      11.10    1.40</span></a>
<a class="sourceLine" id="cb229-37" data-line-number="37"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb229-38" data-line-number="38"><span class="co">#&gt; Correlation of Fixed Effects:</span></a>
<a class="sourceLine" id="cb229-39" data-line-number="39"><span class="co">#&gt;             (Intr) atttdp gendrM</span></a>
<a class="sourceLine" id="cb229-40" data-line-number="40"><span class="co">#&gt; attitudepol -0.238              </span></a>
<a class="sourceLine" id="cb229-41" data-line-number="41"><span class="co">#&gt; genderM     -0.665  0.179       </span></a>
<a class="sourceLine" id="cb229-42" data-line-number="42"><span class="co">#&gt; atttdpl:gnM  0.167 -0.702 -0.252</span></a></code></pre></div>
<p>Note that compared to our earlier model without the fixed effect gender, the variation that’s associated with the random effect “subject” dropped considerably. This is because the variation that’s due to gender was confounded with the variation that’s due to subject. The model didn’t know about males and females, and so its predictions were relatively more off, creating relatively larger residuals. Now that we have added the effect of gender, we have shifted a considerable amount of the variance that was previously in the random effects component (differences between male and female individuals) to the fixed effects component.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb230-1" data-line-number="1"><span class="co"># Random effects:</span></a>
<a class="sourceLine" id="cb230-2" data-line-number="2"><span class="co">#   Groups   Name        Variance Std.Dev.</span></a>
<a class="sourceLine" id="cb230-3" data-line-number="3"><span class="co"># scenario (Intercept) 219.5    14.81   </span></a>
<a class="sourceLine" id="cb230-4" data-line-number="4"><span class="co"># subject  (Intercept) 615.6    24.81   </span></a>
<a class="sourceLine" id="cb230-5" data-line-number="5"><span class="co"># Residual             645.9    25.41   </span></a>
<a class="sourceLine" id="cb230-6" data-line-number="6"><span class="co"># Number of obs: 83, groups:  scenario, 7; subject, 6</span></a></code></pre></div>
<p>We see that males and females differ by about 109 Hz. And the intercept is now much higher (256.846 Hz), as it now represents the female category (for the informal condition). The coefficient for the effect of attitude didn’t change much.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb231-1" data-line-number="1"></a>
<a class="sourceLine" id="cb231-2" data-line-number="2"><span class="co"># Fixed effects:</span></a>
<a class="sourceLine" id="cb231-3" data-line-number="3"><span class="co">#              Estimate Std. Error t value</span></a>
<a class="sourceLine" id="cb231-4" data-line-number="4"><span class="co"># (Intercept)  256.846     16.116  15.938</span></a>
<a class="sourceLine" id="cb231-5" data-line-number="5"><span class="co"># attitudepol  -19.721      5.584  -3.532</span></a>
<a class="sourceLine" id="cb231-6" data-line-number="6"><span class="co"># genderM     -108.516     21.013  -5.164</span></a>
<a class="sourceLine" id="cb231-7" data-line-number="7"></a>
<a class="sourceLine" id="cb231-8" data-line-number="8"><span class="co"># Significance</span></a>
<a class="sourceLine" id="cb231-9" data-line-number="9"></a>
<a class="sourceLine" id="cb231-10" data-line-number="10">politeness.null =<span class="st"> </span><span class="kw">lmer</span>(frequency <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span></a>
<a class="sourceLine" id="cb231-11" data-line-number="11"><span class="st">                         </span>(<span class="dv">1</span><span class="op">|</span>subject) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>scenario), <span class="dt">data=</span>df,</a>
<a class="sourceLine" id="cb231-12" data-line-number="12">                       <span class="dt">REML=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb231-13" data-line-number="13"></a>
<a class="sourceLine" id="cb231-14" data-line-number="14">politeness.model =<span class="st"> </span><span class="kw">lmer</span>(frequency <span class="op">~</span><span class="st"> </span>attitude <span class="op">+</span></a>
<a class="sourceLine" id="cb231-15" data-line-number="15"><span class="st">                          </span>gender <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>subject) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>scenario),</a>
<a class="sourceLine" id="cb231-16" data-line-number="16">                        <span class="dt">data=</span>df, <span class="dt">REML=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb231-17" data-line-number="17"></a>
<a class="sourceLine" id="cb231-18" data-line-number="18"><span class="kw">anova</span>(politeness.null,politeness.model)</a>
<a class="sourceLine" id="cb231-19" data-line-number="19"><span class="co">#&gt; Data: df</span></a>
<a class="sourceLine" id="cb231-20" data-line-number="20"><span class="co">#&gt; Models:</span></a>
<a class="sourceLine" id="cb231-21" data-line-number="21"><span class="co">#&gt; politeness.null: frequency ~ gender + (1 | subject) + (1 | scenario)</span></a>
<a class="sourceLine" id="cb231-22" data-line-number="22"><span class="co">#&gt; politeness.model: frequency ~ attitude + gender + (1 | subject) + (1 | scenario)</span></a>
<a class="sourceLine" id="cb231-23" data-line-number="23"><span class="co">#&gt;                  Df AIC BIC logLik deviance Chisq Chi Df Pr(&gt;Chisq)    </span></a>
<a class="sourceLine" id="cb231-24" data-line-number="24"><span class="co">#&gt; politeness.null   5 817 829   -403      807                            </span></a>
<a class="sourceLine" id="cb231-25" data-line-number="25"><span class="co">#&gt; politeness.model  6 807 822   -398      795  11.6      1    0.00065 ***</span></a>
<a class="sourceLine" id="cb231-26" data-line-number="26"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb231-27" data-line-number="27"><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a>
<a class="sourceLine" id="cb231-28" data-line-number="28"></a>
<a class="sourceLine" id="cb231-29" data-line-number="29"><span class="kw">coef</span>(politeness.model)</a>
<a class="sourceLine" id="cb231-30" data-line-number="30"><span class="co">#&gt; $scenario</span></a>
<a class="sourceLine" id="cb231-31" data-line-number="31"><span class="co">#&gt;   (Intercept) attitudepol genderM</span></a>
<a class="sourceLine" id="cb231-32" data-line-number="32"><span class="co">#&gt; 1         243       -19.7    -109</span></a>
<a class="sourceLine" id="cb231-33" data-line-number="33"><span class="co">#&gt; 2         263       -19.7    -109</span></a>
<a class="sourceLine" id="cb231-34" data-line-number="34"><span class="co">#&gt; 3         268       -19.7    -109</span></a>
<a class="sourceLine" id="cb231-35" data-line-number="35"><span class="co">#&gt; 4         277       -19.7    -109</span></a>
<a class="sourceLine" id="cb231-36" data-line-number="36"><span class="co">#&gt; 5         255       -19.7    -109</span></a>
<a class="sourceLine" id="cb231-37" data-line-number="37"><span class="co">#&gt; 6         245       -19.7    -109</span></a>
<a class="sourceLine" id="cb231-38" data-line-number="38"><span class="co">#&gt; 7         246       -19.7    -109</span></a>
<a class="sourceLine" id="cb231-39" data-line-number="39"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb231-40" data-line-number="40"><span class="co">#&gt; $subject</span></a>
<a class="sourceLine" id="cb231-41" data-line-number="41"><span class="co">#&gt;    (Intercept) attitudepol genderM</span></a>
<a class="sourceLine" id="cb231-42" data-line-number="42"><span class="co">#&gt; F1         243       -19.7    -109</span></a>
<a class="sourceLine" id="cb231-43" data-line-number="43"><span class="co">#&gt; F2         267       -19.7    -109</span></a>
<a class="sourceLine" id="cb231-44" data-line-number="44"><span class="co">#&gt; F3         260       -19.7    -109</span></a>
<a class="sourceLine" id="cb231-45" data-line-number="45"><span class="co">#&gt; M3         284       -19.7    -109</span></a>
<a class="sourceLine" id="cb231-46" data-line-number="46"><span class="co">#&gt; M4         262       -19.7    -109</span></a>
<a class="sourceLine" id="cb231-47" data-line-number="47"><span class="co">#&gt; M7         224       -19.7    -109</span></a>
<a class="sourceLine" id="cb231-48" data-line-number="48"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb231-49" data-line-number="49"><span class="co">#&gt; attr(,&quot;class&quot;)</span></a>
<a class="sourceLine" id="cb231-50" data-line-number="50"><span class="co">#&gt; [1] &quot;coef.mer&quot;</span></a>
<a class="sourceLine" id="cb231-51" data-line-number="51"></a>
<a class="sourceLine" id="cb231-52" data-line-number="52"></a>
<a class="sourceLine" id="cb231-53" data-line-number="53">politeness.model =<span class="st"> </span><span class="kw">lmer</span>(frequency <span class="op">~</span><span class="st"> </span>attitude <span class="op">+</span></a>
<a class="sourceLine" id="cb231-54" data-line-number="54"><span class="st">                          </span>gender <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">+</span>attitude<span class="op">|</span>subject) <span class="op">+</span></a>
<a class="sourceLine" id="cb231-55" data-line-number="55"><span class="st">                          </span>(<span class="dv">1</span><span class="op">+</span>attitude<span class="op">|</span>scenario),</a>
<a class="sourceLine" id="cb231-56" data-line-number="56">                        <span class="dt">data=</span>df,</a>
<a class="sourceLine" id="cb231-57" data-line-number="57">                        <span class="dt">REML=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb231-58" data-line-number="58"></a>
<a class="sourceLine" id="cb231-59" data-line-number="59"></a>
<a class="sourceLine" id="cb231-60" data-line-number="60"></a>
<a class="sourceLine" id="cb231-61" data-line-number="61">politeness.null =<span class="st"> </span><span class="kw">lmer</span>(frequency <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span></a>
<a class="sourceLine" id="cb231-62" data-line-number="62"><span class="st">                         </span>(<span class="dv">1</span><span class="op">+</span>attitude<span class="op">|</span>subject) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">+</span>attitude<span class="op">|</span>scenario),</a>
<a class="sourceLine" id="cb231-63" data-line-number="63">                       <span class="dt">data=</span>df, <span class="dt">REML=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb231-64" data-line-number="64"></a>
<a class="sourceLine" id="cb231-65" data-line-number="65"><span class="kw">anova</span>(politeness.null,politeness.model)</a>
<a class="sourceLine" id="cb231-66" data-line-number="66"><span class="co">#&gt; Data: df</span></a>
<a class="sourceLine" id="cb231-67" data-line-number="67"><span class="co">#&gt; Models:</span></a>
<a class="sourceLine" id="cb231-68" data-line-number="68"><span class="co">#&gt; politeness.null: frequency ~ gender + (1 + attitude | subject) + (1 + attitude | </span></a>
<a class="sourceLine" id="cb231-69" data-line-number="69"><span class="co">#&gt; politeness.null:     scenario)</span></a>
<a class="sourceLine" id="cb231-70" data-line-number="70"><span class="co">#&gt; politeness.model: frequency ~ attitude + gender + (1 + attitude | subject) + (1 + </span></a>
<a class="sourceLine" id="cb231-71" data-line-number="71"><span class="co">#&gt; politeness.model:     attitude | scenario)</span></a>
<a class="sourceLine" id="cb231-72" data-line-number="72"><span class="co">#&gt;                  Df AIC BIC logLik deviance Chisq Chi Df Pr(&gt;Chisq)   </span></a>
<a class="sourceLine" id="cb231-73" data-line-number="73"><span class="co">#&gt; politeness.null   9 820 841   -401      802                           </span></a>
<a class="sourceLine" id="cb231-74" data-line-number="74"><span class="co">#&gt; politeness.model 10 815 839   -397      795  6.71      1     0.0096 **</span></a>
<a class="sourceLine" id="cb231-75" data-line-number="75"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb231-76" data-line-number="76"><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a>
<a class="sourceLine" id="cb231-77" data-line-number="77"></a>
<a class="sourceLine" id="cb231-78" data-line-number="78">politeness.model=<span class="kw">lmer</span>(frequency<span class="op">~</span>attitude<span class="op">+</span>gender<span class="op">+</span>(<span class="dv">1</span><span class="op">+</span>attitude<span class="op">|</span>scenario), <span class="dt">data =</span> df, <span class="dt">REML =</span> F)</a></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-models.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://spencercastro.com/08_MultilevelModels.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
