<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Multilevel Models | Data Analysis and Optimization in R</title>
  <meta name="description" content="As modern Data Scientists, we cannot be content with untested assumptions, decisions based on the “gut feelings” of a CEO, poorly leveraged data insights, or small sample sizes; now we must strive to be methodologically sound, balance experimental design against convenient populations, keep up with the ever-changing landscape of statistical tests and their caveats, and learn rudimentary computer programming on top of that! Therefore we need a tool that balances the comprehensibility of human language with the flexibility to keep up with developing statistical methods and the power to analyze and vizualize any dataset. Enter R, the open-source statistical computing and graphics language with a powerful Integrated Development Environment (the Rstudio IDE), a robust community of developers, data scientists, and experts (who respond to questions!), and too many reputable online resources to read in a lifetime. The impetus to learn something new on top of your ongoing research may be hard to summon, but this course is designed to integrate your ongoing projects and goals into mastering R, and to provide tools for streamlining projects in the future." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Multilevel Models | Data Analysis and Optimization in R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://spencercastro.com/assets/image/ucmSeals/UCM_Seal_FullColor_2019.png" />
  <meta property="og:description" content="As modern Data Scientists, we cannot be content with untested assumptions, decisions based on the “gut feelings” of a CEO, poorly leveraged data insights, or small sample sizes; now we must strive to be methodologically sound, balance experimental design against convenient populations, keep up with the ever-changing landscape of statistical tests and their caveats, and learn rudimentary computer programming on top of that! Therefore we need a tool that balances the comprehensibility of human language with the flexibility to keep up with developing statistical methods and the power to analyze and vizualize any dataset. Enter R, the open-source statistical computing and graphics language with a powerful Integrated Development Environment (the Rstudio IDE), a robust community of developers, data scientists, and experts (who respond to questions!), and too many reputable online resources to read in a lifetime. The impetus to learn something new on top of your ongoing research may be hard to summon, but this course is designed to integrate your ongoing projects and goals into mastering R, and to provide tools for streamlining projects in the future." />
  <meta name="github-repo" content="sccastro/PsychMeasurement" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Multilevel Models | Data Analysis and Optimization in R" />
  
  <meta name="twitter:description" content="As modern Data Scientists, we cannot be content with untested assumptions, decisions based on the “gut feelings” of a CEO, poorly leveraged data insights, or small sample sizes; now we must strive to be methodologically sound, balance experimental design against convenient populations, keep up with the ever-changing landscape of statistical tests and their caveats, and learn rudimentary computer programming on top of that! Therefore we need a tool that balances the comprehensibility of human language with the flexibility to keep up with developing statistical methods and the power to analyze and vizualize any dataset. Enter R, the open-source statistical computing and graphics language with a powerful Integrated Development Environment (the Rstudio IDE), a robust community of developers, data scientists, and experts (who respond to questions!), and too many reputable online resources to read in a lifetime. The impetus to learn something new on top of your ongoing research may be hard to summon, but this course is designed to integrate your ongoing projects and goals into mastering R, and to provide tools for streamlining projects in the future." />
  <meta name="twitter:image" content="https://spencercastro.com/assets/image/ucmSeals/UCM_Seal_FullColor_2019.png" />

<meta name="author" content="Spencer Castro" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-models.html"/>
<link rel="next" href="rmarkdown.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="class_book.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Data Analysis and Optimization in R</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="syllabus.html"><a href="syllabus.html"><i class="fa fa-check"></i><b>1</b> Syllabus</a>
<ul>
<li class="chapter" data-level="1.1" data-path="syllabus.html"><a href="syllabus.html#instructor-information"><i class="fa fa-check"></i><b>1.1</b> Instructor Information</a></li>
<li class="chapter" data-level="1.2" data-path="syllabus.html"><a href="syllabus.html#books"><i class="fa fa-check"></i><b>1.2</b> Books</a></li>
<li class="chapter" data-level="1.3" data-path="syllabus.html"><a href="syllabus.html#course-overview"><i class="fa fa-check"></i><b>1.3</b> Course Overview</a></li>
<li class="chapter" data-level="1.4" data-path="syllabus.html"><a href="syllabus.html#learning-outcomes-course-objectives"><i class="fa fa-check"></i><b>1.4</b> Learning Outcomes &amp; Course Objectives</a></li>
<li class="chapter" data-level="1.5" data-path="syllabus.html"><a href="syllabus.html#course-format"><i class="fa fa-check"></i><b>1.5</b> Course Format</a></li>
<li class="chapter" data-level="1.6" data-path="syllabus.html"><a href="syllabus.html#evaluation-methodsassignments"><i class="fa fa-check"></i><b>1.6</b> Evaluation Methods/Assignments</a></li>
<li class="chapter" data-level="1.7" data-path="syllabus.html"><a href="syllabus.html#grading-policy"><i class="fa fa-check"></i><b>1.7</b> Grading Policy</a></li>
<li class="chapter" data-level="1.8" data-path="syllabus.html"><a href="syllabus.html#student-rights-and-responsibilities"><i class="fa fa-check"></i><b>1.8</b> Student Rights and Responsibilities</a></li>
<li class="chapter" data-level="1.9" data-path="syllabus.html"><a href="syllabus.html#course-policies"><i class="fa fa-check"></i><b>1.9</b> Course Policies</a></li>
<li class="chapter" data-level="1.10" data-path="syllabus.html"><a href="syllabus.html#university-attendance-requirements"><i class="fa fa-check"></i><b>1.10</b> University Attendance Requirements</a></li>
<li class="chapter" data-level="1.11" data-path="syllabus.html"><a href="syllabus.html#student-support-accommodations"><i class="fa fa-check"></i><b>1.11</b> Student Support &amp; Accommodations</a></li>
<li class="chapter" data-level="1.12" data-path="syllabus.html"><a href="syllabus.html#academic-calendar"><i class="fa fa-check"></i><b>1.12</b> Academic Calendar</a></li>
<li class="chapter" data-level="1.13" data-path="syllabus.html"><a href="syllabus.html#course-schedule"><i class="fa fa-check"></i><b>1.13</b> Course Schedule</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#baser-walkthrough"><i class="fa fa-check"></i>BaseR walkthrough</a></li>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#help"><i class="fa fa-check"></i><b>2.1</b> Help</a></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#vectors"><i class="fa fa-check"></i><b>2.2</b> VECTORS</a></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#programming"><i class="fa fa-check"></i><b>2.3</b> PROGRAMMING</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="introduction.html"><a href="introduction.html#for-loop"><i class="fa fa-check"></i><b>2.3.1</b> For loop</a></li>
<li class="chapter" data-level="2.3.2" data-path="introduction.html"><a href="introduction.html#while-loop"><i class="fa fa-check"></i><b>2.3.2</b> While loop</a></li>
<li class="chapter" data-level="2.3.3" data-path="introduction.html"><a href="introduction.html#ifelse-statement"><i class="fa fa-check"></i><b>2.3.3</b> Ifelse statement</a></li>
<li class="chapter" data-level="2.3.4" data-path="introduction.html"><a href="introduction.html#function"><i class="fa fa-check"></i><b>2.3.4</b> Function</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="introduction.html"><a href="introduction.html#assignment-1"><i class="fa fa-check"></i><b>2.4</b> Assignment 1</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i><b>3</b> Importing Data</a>
<ul>
<li class="chapter" data-level="" data-path="importing-data.html"><a href="importing-data.html#reading-files-into-r"><i class="fa fa-check"></i>Reading files into R</a></li>
<li class="chapter" data-level="3.1" data-path="importing-data.html"><a href="importing-data.html#whats-a-tibble"><i class="fa fa-check"></i><b>3.1</b> What’s a tibble?</a></li>
<li class="chapter" data-level="3.2" data-path="importing-data.html"><a href="importing-data.html#save-your-dataset"><i class="fa fa-check"></i><b>3.2</b> Save your dataset:</a></li>
<li class="chapter" data-level="3.3" data-path="importing-data.html"><a href="importing-data.html#cleaning-your-data-file"><i class="fa fa-check"></i><b>3.3</b> Cleaning your data file</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>4</b> Data Transformation</a>
<ul>
<li class="chapter" data-level="" data-path="data-transformation.html"><a href="data-transformation.html#data-transformation-with-dplyr"><i class="fa fa-check"></i>Data Transformation with Dplyr</a></li>
<li class="chapter" data-level="4.1" data-path="data-transformation.html"><a href="data-transformation.html#get-a-dataset-from-your-.rdata-file"><i class="fa fa-check"></i><b>4.1</b> Get a dataset from your .RData file</a></li>
<li class="chapter" data-level="4.2" data-path="data-transformation.html"><a href="data-transformation.html#introduction-to-the-pipe"><i class="fa fa-check"></i><b>4.2</b> Introduction to “The Pipe”</a></li>
<li class="chapter" data-level="4.3" data-path="data-transformation.html"><a href="data-transformation.html#aside-on-the-apply-family"><i class="fa fa-check"></i><b>4.3</b> Aside on the apply family</a></li>
<li class="chapter" data-level="4.4" data-path="data-transformation.html"><a href="data-transformation.html#extracting-rows"><i class="fa fa-check"></i><b>4.4</b> Extracting rows</a></li>
<li class="chapter" data-level="4.5" data-path="data-transformation.html"><a href="data-transformation.html#spreading-gathering-separating-and-uniting"><i class="fa fa-check"></i><b>4.5</b> Spreading, Gathering, Separating and Uniting</a></li>
<li class="chapter" data-level="4.6" data-path="data-transformation.html"><a href="data-transformation.html#solutions-to-challenges"><i class="fa fa-check"></i><b>4.6</b> Solutions to Challenges</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-transformation-day-2.html"><a href="data-transformation-day-2.html"><i class="fa fa-check"></i><b>5</b> Data Transformation Day 2</a>
<ul>
<li class="chapter" data-level="" data-path="data-transformation-day-2.html"><a href="data-transformation-day-2.html#day-2"><i class="fa fa-check"></i>Day 2</a></li>
<li class="chapter" data-level="5.1" data-path="data-transformation-day-2.html"><a href="data-transformation-day-2.html#change-the-order-of-the-levels"><i class="fa fa-check"></i><b>5.1</b> Change the order of the levels</a></li>
<li class="chapter" data-level="5.2" data-path="data-transformation-day-2.html"><a href="data-transformation-day-2.html#rcolorbrewer"><i class="fa fa-check"></i><b>5.2</b> RcolorBrewer</a></li>
<li class="chapter" data-level="5.3" data-path="data-transformation-day-2.html"><a href="data-transformation-day-2.html#modifying-factor-levels"><i class="fa fa-check"></i><b>5.3</b> Modifying Factor Levels</a></li>
<li class="chapter" data-level="5.4" data-path="data-transformation-day-2.html"><a href="data-transformation-day-2.html#play-time"><i class="fa fa-check"></i><b>5.4</b> Play time</a></li>
<li class="chapter" data-level="5.5" data-path="data-transformation-day-2.html"><a href="data-transformation-day-2.html#solutions"><i class="fa fa-check"></i><b>5.5</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="visualization-with-ggplot2.html"><a href="visualization-with-ggplot2.html"><i class="fa fa-check"></i><b>6</b> Visualization with ggplot2</a>
<ul>
<li class="chapter" data-level="" data-path="visualization-with-ggplot2.html"><a href="visualization-with-ggplot2.html#steps-of-visualization"><i class="fa fa-check"></i>Steps of Visualization</a></li>
<li class="chapter" data-level="6.1" data-path="visualization-with-ggplot2.html"><a href="visualization-with-ggplot2.html#ggplot2"><i class="fa fa-check"></i><b>6.1</b> ggplot2</a></li>
<li class="chapter" data-level="6.2" data-path="visualization-with-ggplot2.html"><a href="visualization-with-ggplot2.html#linetypes"><i class="fa fa-check"></i><b>6.2</b> Linetypes</a></li>
<li class="chapter" data-level="6.3" data-path="visualization-with-ggplot2.html"><a href="visualization-with-ggplot2.html#symbols"><i class="fa fa-check"></i><b>6.3</b> Symbols</a></li>
<li class="chapter" data-level="6.4" data-path="visualization-with-ggplot2.html"><a href="visualization-with-ggplot2.html#play-time-1"><i class="fa fa-check"></i><b>6.4</b> Play time</a></li>
<li class="chapter" data-level="6.5" data-path="visualization-with-ggplot2.html"><a href="visualization-with-ggplot2.html#statistical-transformations"><i class="fa fa-check"></i><b>6.5</b> Statistical Transformations</a></li>
<li class="chapter" data-level="6.6" data-path="visualization-with-ggplot2.html"><a href="visualization-with-ggplot2.html#changing-the-position"><i class="fa fa-check"></i><b>6.6</b> Changing the position</a></li>
<li class="chapter" data-level="6.7" data-path="visualization-with-ggplot2.html"><a href="visualization-with-ggplot2.html#coordinates"><i class="fa fa-check"></i><b>6.7</b> Coordinates</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="visualization-with-ggplot2.html"><a href="visualization-with-ggplot2.html#plot-maps-if-you-want"><i class="fa fa-check"></i><b>6.7.1</b> Plot maps if you want</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html"><i class="fa fa-check"></i><b>7</b> Introduction to Statistics</a>
<ul>
<li class="chapter" data-level="" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#stats"><i class="fa fa-check"></i>Stats</a></li>
<li class="chapter" data-level="7.1" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#steps-of-visualization-1"><i class="fa fa-check"></i><b>7.1</b> Steps of Visualization</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#descriptive-stats"><i class="fa fa-check"></i><b>7.1.1</b> Descriptive Stats</a></li>
<li class="chapter" data-level="7.1.2" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>7.1.2</b> Measures of Central Tendency</a></li>
<li class="chapter" data-level="7.1.3" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#measures-of-variability"><i class="fa fa-check"></i><b>7.1.3</b> Measures of Variability</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#clinical-trial-example"><i class="fa fa-check"></i><b>7.2</b> Clinical Trial Example</a></li>
<li class="chapter" data-level="7.3" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#correlations"><i class="fa fa-check"></i><b>7.3</b> Correlations</a></li>
<li class="chapter" data-level="7.4" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#categorical-data-navarro-pg.-351"><i class="fa fa-check"></i><b>7.4</b> Categorical Data – Navarro pg. 351</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#chi-square-goodness-of-fit-test-pearson-1900-review"><i class="fa fa-check"></i><b>7.4.1</b> Chi Square goodness-of-fit test (Pearson, 1900) Review</a></li>
<li class="chapter" data-level="7.4.2" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#chi-square-test-of-independence"><i class="fa fa-check"></i><b>7.4.2</b> Chi-square test of independence</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#t.test"><i class="fa fa-check"></i><b>7.5</b> T.TEST</a></li>
<li class="chapter" data-level="7.6" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#effect-size"><i class="fa fa-check"></i><b>7.6</b> Effect Size</a></li>
<li class="chapter" data-level="7.7" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#assumptions"><i class="fa fa-check"></i><b>7.7</b> Assumptions</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#shapiro-normality-test"><i class="fa fa-check"></i><b>7.7.1</b> Shapiro normality test</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#one-way-anova"><i class="fa fa-check"></i><b>7.8</b> One-Way ANOVA</a></li>
<li class="chapter" data-level="7.9" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#aaaanndd-regression"><i class="fa fa-check"></i><b>7.9</b> AAAANNDD Regression</a></li>
<li class="chapter" data-level="7.10" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#solutions-1"><i class="fa fa-check"></i><b>7.10</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>8</b> Linear Models</a>
<ul>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#steps-of-linear-models"><i class="fa fa-check"></i>Steps of Linear Models</a></li>
<li class="chapter" data-level="8.1" data-path="linear-models.html"><a href="linear-models.html#step-1.-get-your-data"><i class="fa fa-check"></i><b>8.1</b> Step 1. Get your data</a></li>
<li class="chapter" data-level="8.2" data-path="linear-models.html"><a href="linear-models.html#solutions-2"><i class="fa fa-check"></i><b>8.2</b> Solutions</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="linear-models.html"><a href="linear-models.html#challenge-2"><i class="fa fa-check"></i><b>8.2.1</b> Challenge 2</a></li>
<li class="chapter" data-level="8.2.2" data-path="linear-models.html"><a href="linear-models.html#challenge-3"><i class="fa fa-check"></i><b>8.2.2</b> Challenge 3</a></li>
<li class="chapter" data-level="8.2.3" data-path="linear-models.html"><a href="linear-models.html#challenge-4"><i class="fa fa-check"></i><b>8.2.3</b> Challenge 4</a></li>
<li class="chapter" data-level="8.2.4" data-path="linear-models.html"><a href="linear-models.html#challenge-5"><i class="fa fa-check"></i><b>8.2.4</b> Challenge 5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="multilevel-models.html"><a href="multilevel-models.html"><i class="fa fa-check"></i><b>9</b> Multilevel Models</a>
<ul>
<li class="chapter" data-level="" data-path="multilevel-models.html"><a href="multilevel-models.html#steps-of-multilevel-models"><i class="fa fa-check"></i>Steps of Multilevel Models</a></li>
<li class="chapter" data-level="9.1" data-path="multilevel-models.html"><a href="multilevel-models.html#step-1.-get-your-data-1"><i class="fa fa-check"></i><b>9.1</b> Step 1. Get your data</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="multilevel-models.html"><a href="multilevel-models.html#mixed-models-in-r"><i class="fa fa-check"></i><b>9.1.1</b> Mixed models in R</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="multilevel-models.html"><a href="multilevel-models.html#solutions-3"><i class="fa fa-check"></i><b>9.2</b> Solutions</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="multilevel-models.html"><a href="multilevel-models.html#challenge-1"><i class="fa fa-check"></i><b>9.2.1</b> Challenge 1</a></li>
<li class="chapter" data-level="9.2.2" data-path="multilevel-models.html"><a href="multilevel-models.html#challenge-2-1"><i class="fa fa-check"></i><b>9.2.2</b> Challenge 2</a></li>
<li class="chapter" data-level="9.2.3" data-path="multilevel-models.html"><a href="multilevel-models.html#challenge-3-1"><i class="fa fa-check"></i><b>9.2.3</b> Challenge 3</a></li>
<li class="chapter" data-level="9.2.4" data-path="multilevel-models.html"><a href="multilevel-models.html#challenge-4-1"><i class="fa fa-check"></i><b>9.2.4</b> Challenge 4</a></li>
<li class="chapter" data-level="9.2.5" data-path="multilevel-models.html"><a href="multilevel-models.html#challenge-5-1"><i class="fa fa-check"></i><b>9.2.5</b> Challenge 5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>10</b> Rmarkdown</a>
<ul>
<li class="chapter" data-level="10.1" data-path="rmarkdown.html"><a href="rmarkdown.html#basics"><i class="fa fa-check"></i><b>10.1</b> Basics</a></li>
<li class="chapter" data-level="10.2" data-path="rmarkdown.html"><a href="rmarkdown.html#output-formats"><i class="fa fa-check"></i><b>10.2</b> Output Formats</a></li>
<li class="chapter" data-level="10.3" data-path="rmarkdown.html"><a href="rmarkdown.html#rmarkdown-syntax"><i class="fa fa-check"></i><b>10.3</b> Rmarkdown Syntax</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="rmarkdown.html"><a href="rmarkdown.html#in-line-formatting"><i class="fa fa-check"></i><b>10.3.1</b> In-line Formatting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="rmarkdown-day-2.html"><a href="rmarkdown-day-2.html"><i class="fa fa-check"></i><b>11</b> Rmarkdown Day 2</a></li>
<li class="chapter" data-level="12" data-path="blogdown.html"><a href="blogdown.html"><i class="fa fa-check"></i><b>12</b> Blogdown</a>
<ul>
<li class="chapter" data-level="12.1" data-path="blogdown.html"><a href="blogdown.html#rmarkdown-website"><i class="fa fa-check"></i><b>12.1</b> Rmarkdown Website</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="shiny-applications.html"><a href="shiny-applications.html"><i class="fa fa-check"></i><b>13</b> Shiny Applications</a></li>
<li class="chapter" data-level="14" data-path="kmeans-app.html"><a href="kmeans-app.html"><i class="fa fa-check"></i><b>14</b> 01-kmeans-app</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis and Optimization in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multilevel-models" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">9</span> Multilevel Models<a href="multilevel-models.html#multilevel-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote>
<p>“When we go to run our stats and test our hypotheses about the world,
what if we didn’t assume everyone was the same?”</p>
<div style="text-align: right">
<p>— Ty Mckinney</p>
</div>
</blockquote>
<blockquote>
<p>“The Earth is round (p &lt; .05).”</p>
<div style="text-align: right">
<p>— Jacob Cohen</p>
</div>
</blockquote>
<p>First off…</p>
<h4>
Advanced R Challenges
</h4>
<p>APPLY A “MIXED EFFECTS” MODEL TO YOUR DATASET (if it doesn’t make sense
with your data, find a dataset for within and between variables in
“datasets”)</p>
<div id="steps-of-multilevel-models" class="section level2 unnumbered hasAnchor">
<h2>Steps of Multilevel Models<a href="multilevel-models.html#steps-of-multilevel-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="step-1.-get-your-data-1" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Step 1. Get your data<a href="multilevel-models.html#step-1.-get-your-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="multilevel-models.html#cb235-1" tabindex="-1"></a><span class="fu">require</span>(tidyverse)</span>
<span id="cb235-2"><a href="multilevel-models.html#cb235-2" tabindex="-1"></a></span>
<span id="cb235-3"><a href="multilevel-models.html#cb235-3" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;~/Dropbox/Teaching/MIST130DatAnOpt_22/books_resources/politeness_data.csv&quot;</span>)</span>
<span id="cb235-4"><a href="multilevel-models.html#cb235-4" tabindex="-1"></a><span class="co">#&gt; Rows: 84 Columns: 5</span></span>
<span id="cb235-5"><a href="multilevel-models.html#cb235-5" tabindex="-1"></a><span class="co">#&gt; ── Column specification ────────────────────────────────────────────────────────</span></span>
<span id="cb235-6"><a href="multilevel-models.html#cb235-6" tabindex="-1"></a><span class="co">#&gt; Delimiter: &quot;,&quot;</span></span>
<span id="cb235-7"><a href="multilevel-models.html#cb235-7" tabindex="-1"></a><span class="co">#&gt; chr (3): subject, gender, attitude</span></span>
<span id="cb235-8"><a href="multilevel-models.html#cb235-8" tabindex="-1"></a><span class="co">#&gt; dbl (2): scenario, frequency</span></span>
<span id="cb235-9"><a href="multilevel-models.html#cb235-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb235-10"><a href="multilevel-models.html#cb235-10" tabindex="-1"></a><span class="co">#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span id="cb235-11"><a href="multilevel-models.html#cb235-11" tabindex="-1"></a><span class="co">#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre></div>
<p>In our study, politeness is treated as a categorical factor with two
levels… a formal register and an informal register. On top of that, we
also had an additional fixed effect, sex, and so our formula looks more
like this:</p>
<p><span class="math display">\[ pitch \sim politeness + sex + ε \]</span></p>
<p>So far so good. Now things get a little more complicated. Our design was
so that we took multiple measures per subject. That is, each subject
gave multiple polite responses and multiple informal responses. If we go
back to the discussion of the assumptions of the linear model in Chapter
7, we can immediately see that this would violate the independence
assumption: Multiple responses from the same subject cannot be regarded
as independent from each other. Every person has a slightly different
voice pitch, and this is going to be an idiosyncratic factor that
affects all responses from the same subject, thus rendering these
different responses inter-dependent rather than independent.</p>
<p>The way we’re going to deal with this situation is to add a random
effect for subject. This allows us to resolve this non-independence by
assuming a different “baseline” pitch value for each subject. So,
subject 1 may have a mean voice pitch of 233 Hz across different
utterances, and subject 2 may have a mean voice pitch of 210 Hz per
subject. Here’s a visual depiction of how this looks like:</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="multilevel-models.html#cb236-1" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb236-2"><a href="multilevel-models.html#cb236-2" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb236-3"><a href="multilevel-models.html#cb236-3" tabindex="-1"></a>  <span class="fu">group_by</span>(subject,scenario, attitude) <span class="sc">%&gt;%</span></span>
<span id="cb236-4"><a href="multilevel-models.html#cb236-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mfreq =</span> <span class="fu">mean</span>(frequency)) <span class="sc">%&gt;%</span></span>
<span id="cb236-5"><a href="multilevel-models.html#cb236-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> subject, <span class="at">y =</span> mfreq)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span>
<span id="cb236-6"><a href="multilevel-models.html#cb236-6" tabindex="-1"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;subject&#39;, &#39;scenario&#39;. You can override using the `.groups` argument.</span></span></code></pre></div>
<p><img src="08_MultilevelModels_files/figure-html/interdependence-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>We can model these individual differences by assuming different random
intercepts for each subject. That is, each subject is assigned a
different intercept value, and the mixed model estimates these
intercepts for you.</p>
<p>Now you begin to see why the mixed model is called a “mixed” model. The
linear models that we considered so far have been “fixed-effects-only”
models that had one or more fixed effects and a general error term “ε”.
With the linear model, we essentially divided the world into things that
we somehow understand or that are somehow systematic (the fixed effects,
or the explanatory variables); and things that we cannot control for or
that we don’t understand (ε). But crucially, this latter part, the
unsystematic part of the model, did not have any interesting structure.
We simply had a general across-the-board error term. In the mixed model,
we add one or more random effects to our fixed effects. These random
effects essentially give structure to the error term “ε”. In the case of
our model here, we add a random effect for “subject”, and this
characterizes idiosyncratic variation that is due to individual
differences. The mixture of fixed and random effects is what makes the
mixed model a mixed model.</p>
<p>Our updated formula looks like this:</p>
<p><span class="math display">\[ pitch \sim politeness + sex + (1|subject) + ε \]</span></p>
<p>“(1|subject)” looks a little enigmatic. I’m already using the R-typical
notation format here. What this is saying is “assume an intercept that’s
different for each subject” … and “1” stands for the intercept here.
You can think of this formula as telling your model that it should
expect that there’s going to be multiple responses per subject, and
these responses will depend on each subject’s baseline level. This
effectively resolves the non-independence that stems from having
multiple responses by the same subject.</p>
<p>Subjects also had to imagine asking a professor for a favor (polite
condition), or asking a peer for a favor (informal condition). An
example of a scenario was: item was an “excusing for coming too late”
scenario, which was similarly divided between polite and informal. In
total, there were 7 such different items.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="multilevel-models.html#cb237-1" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb237-2"><a href="multilevel-models.html#cb237-2" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb237-3"><a href="multilevel-models.html#cb237-3" tabindex="-1"></a>  <span class="fu">group_by</span>(subject,scenario, attitude) <span class="sc">%&gt;%</span></span>
<span id="cb237-4"><a href="multilevel-models.html#cb237-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mfreq =</span> <span class="fu">mean</span>(frequency)) <span class="sc">%&gt;%</span></span>
<span id="cb237-5"><a href="multilevel-models.html#cb237-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> scenario, <span class="at">y =</span> mfreq, <span class="at">group =</span> scenario)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span>
<span id="cb237-6"><a href="multilevel-models.html#cb237-6" tabindex="-1"></a><span class="co">#&gt; `summarise()` has grouped output by &#39;subject&#39;, &#39;scenario&#39;. You can override using the `.groups` argument.</span></span>
<span id="cb237-7"><a href="multilevel-models.html#cb237-7" tabindex="-1"></a></span>
<span id="cb237-8"><a href="multilevel-models.html#cb237-8" tabindex="-1"></a></span>
<span id="cb237-9"><a href="multilevel-models.html#cb237-9" tabindex="-1"></a></span>
<span id="cb237-10"><a href="multilevel-models.html#cb237-10" tabindex="-1"></a></span>
<span id="cb237-11"><a href="multilevel-models.html#cb237-11" tabindex="-1"></a><span class="co"># Challenge 1 -------------------------------------------------------------</span></span>
<span id="cb237-12"><a href="multilevel-models.html#cb237-12" tabindex="-1"></a> </span>
<span id="cb237-13"><a href="multilevel-models.html#cb237-13" tabindex="-1"></a><span class="co"># What happens if we leave out the &quot;group&quot; argument to aes()?</span></span>
<span id="cb237-14"><a href="multilevel-models.html#cb237-14" tabindex="-1"></a><span class="co"># Why?</span></span>
<span id="cb237-15"><a href="multilevel-models.html#cb237-15" tabindex="-1"></a></span>
<span id="cb237-16"><a href="multilevel-models.html#cb237-16" tabindex="-1"></a></span>
<span id="cb237-17"><a href="multilevel-models.html#cb237-17" tabindex="-1"></a><span class="co"># How do we account for variation in scenario?</span></span></code></pre></div>
<p><img src="08_MultilevelModels_files/figure-html/unnamed-chunk-2-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>We do this by adding an additional random effect:</p>
<p><span class="math display">\[ pitch \sim politeness + sex + (1|subject) + (1|item) + ε \]</span></p>
<div id="mixed-models-in-r" class="section level3 hasAnchor" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Mixed models in R<a href="multilevel-models.html#mixed-models-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="step-2." class="section level4 hasAnchor" number="9.1.1.1">
<h4><span class="header-section-number">9.1.1.1</span> Step 2.<a href="multilevel-models.html#step-2." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For a start, we need to install the R package lme4 (Bates, Maechler &amp;
Bolker, 2012). open R and type in:</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="multilevel-models.html#cb238-1" tabindex="-1"></a><span class="co"># install.packages(&quot;lme4&quot;)</span></span></code></pre></div>
<p>After installation, load the lme4 package into R with the following
command:</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="multilevel-models.html#cb239-1" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb239-2"><a href="multilevel-models.html#cb239-2" tabindex="-1"></a><span class="co">#&gt; Loading required package: Matrix</span></span>
<span id="cb239-3"><a href="multilevel-models.html#cb239-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb239-4"><a href="multilevel-models.html#cb239-4" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;Matrix&#39;</span></span>
<span id="cb239-5"><a href="multilevel-models.html#cb239-5" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:tidyr&#39;:</span></span>
<span id="cb239-6"><a href="multilevel-models.html#cb239-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb239-7"><a href="multilevel-models.html#cb239-7" tabindex="-1"></a><span class="co">#&gt;     expand, pack, unpack</span></span></code></pre></div>
<p>Now, you have the function <code>lmer()</code> available to you, which
is the mixed model equivalent of the function <code>lm()</code> in
tutorial 1. This function is going to construct mixed models for us.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="multilevel-models.html#cb240-1" tabindex="-1"></a>politeness.model <span class="ot">=</span> <span class="fu">lmer</span>(frequency <span class="sc">~</span> attitude <span class="sc">+</span></span>
<span id="cb240-2"><a href="multilevel-models.html#cb240-2" tabindex="-1"></a>                          (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>scenario), <span class="at">data=</span>df)</span>
<span id="cb240-3"><a href="multilevel-models.html#cb240-3" tabindex="-1"></a></span>
<span id="cb240-4"><a href="multilevel-models.html#cb240-4" tabindex="-1"></a></span>
<span id="cb240-5"><a href="multilevel-models.html#cb240-5" tabindex="-1"></a><span class="fu">summary</span>(politeness.model)</span>
<span id="cb240-6"><a href="multilevel-models.html#cb240-6" tabindex="-1"></a><span class="co">#&gt; Linear mixed model fit by REML [&#39;lmerMod&#39;]</span></span>
<span id="cb240-7"><a href="multilevel-models.html#cb240-7" tabindex="-1"></a><span class="co">#&gt; Formula: frequency ~ attitude + (1 | subject) + (1 | scenario)</span></span>
<span id="cb240-8"><a href="multilevel-models.html#cb240-8" tabindex="-1"></a><span class="co">#&gt;    Data: df</span></span>
<span id="cb240-9"><a href="multilevel-models.html#cb240-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb240-10"><a href="multilevel-models.html#cb240-10" tabindex="-1"></a><span class="co">#&gt; REML criterion at convergence: 794</span></span>
<span id="cb240-11"><a href="multilevel-models.html#cb240-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb240-12"><a href="multilevel-models.html#cb240-12" tabindex="-1"></a><span class="co">#&gt; Scaled residuals: </span></span>
<span id="cb240-13"><a href="multilevel-models.html#cb240-13" tabindex="-1"></a><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span id="cb240-14"><a href="multilevel-models.html#cb240-14" tabindex="-1"></a><span class="co">#&gt; -2.201 -0.582 -0.064  0.563  3.439 </span></span>
<span id="cb240-15"><a href="multilevel-models.html#cb240-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb240-16"><a href="multilevel-models.html#cb240-16" tabindex="-1"></a><span class="co">#&gt; Random effects:</span></span>
<span id="cb240-17"><a href="multilevel-models.html#cb240-17" tabindex="-1"></a><span class="co">#&gt;  Groups   Name        Variance Std.Dev.</span></span>
<span id="cb240-18"><a href="multilevel-models.html#cb240-18" tabindex="-1"></a><span class="co">#&gt;  scenario (Intercept)  219     14.8    </span></span>
<span id="cb240-19"><a href="multilevel-models.html#cb240-19" tabindex="-1"></a><span class="co">#&gt;  subject  (Intercept) 4015     63.4    </span></span>
<span id="cb240-20"><a href="multilevel-models.html#cb240-20" tabindex="-1"></a><span class="co">#&gt;  Residual              646     25.4    </span></span>
<span id="cb240-21"><a href="multilevel-models.html#cb240-21" tabindex="-1"></a><span class="co">#&gt; Number of obs: 83, groups:  scenario, 7; subject, 6</span></span>
<span id="cb240-22"><a href="multilevel-models.html#cb240-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb240-23"><a href="multilevel-models.html#cb240-23" tabindex="-1"></a><span class="co">#&gt; Fixed effects:</span></span>
<span id="cb240-24"><a href="multilevel-models.html#cb240-24" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value</span></span>
<span id="cb240-25"><a href="multilevel-models.html#cb240-25" tabindex="-1"></a><span class="co">#&gt; (Intercept)   202.59      26.75    7.57</span></span>
<span id="cb240-26"><a href="multilevel-models.html#cb240-26" tabindex="-1"></a><span class="co">#&gt; attitudepol   -19.69       5.58   -3.53</span></span>
<span id="cb240-27"><a href="multilevel-models.html#cb240-27" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb240-28"><a href="multilevel-models.html#cb240-28" tabindex="-1"></a><span class="co">#&gt; Correlation of Fixed Effects:</span></span>
<span id="cb240-29"><a href="multilevel-models.html#cb240-29" tabindex="-1"></a><span class="co">#&gt;             (Intr)</span></span>
<span id="cb240-30"><a href="multilevel-models.html#cb240-30" tabindex="-1"></a><span class="co">#&gt; attitudepol -0.103</span></span>
<span id="cb240-31"><a href="multilevel-models.html#cb240-31" tabindex="-1"></a></span>
<span id="cb240-32"><a href="multilevel-models.html#cb240-32" tabindex="-1"></a><span class="fu">coef</span>(politeness.model)</span>
<span id="cb240-33"><a href="multilevel-models.html#cb240-33" tabindex="-1"></a><span class="co">#&gt; $scenario</span></span>
<span id="cb240-34"><a href="multilevel-models.html#cb240-34" tabindex="-1"></a><span class="co">#&gt;   (Intercept) attitudepol</span></span>
<span id="cb240-35"><a href="multilevel-models.html#cb240-35" tabindex="-1"></a><span class="co">#&gt; 1         189       -19.7</span></span>
<span id="cb240-36"><a href="multilevel-models.html#cb240-36" tabindex="-1"></a><span class="co">#&gt; 2         209       -19.7</span></span>
<span id="cb240-37"><a href="multilevel-models.html#cb240-37" tabindex="-1"></a><span class="co">#&gt; 3         214       -19.7</span></span>
<span id="cb240-38"><a href="multilevel-models.html#cb240-38" tabindex="-1"></a><span class="co">#&gt; 4         223       -19.7</span></span>
<span id="cb240-39"><a href="multilevel-models.html#cb240-39" tabindex="-1"></a><span class="co">#&gt; 5         201       -19.7</span></span>
<span id="cb240-40"><a href="multilevel-models.html#cb240-40" tabindex="-1"></a><span class="co">#&gt; 6         190       -19.7</span></span>
<span id="cb240-41"><a href="multilevel-models.html#cb240-41" tabindex="-1"></a><span class="co">#&gt; 7         192       -19.7</span></span>
<span id="cb240-42"><a href="multilevel-models.html#cb240-42" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb240-43"><a href="multilevel-models.html#cb240-43" tabindex="-1"></a><span class="co">#&gt; $subject</span></span>
<span id="cb240-44"><a href="multilevel-models.html#cb240-44" tabindex="-1"></a><span class="co">#&gt;    (Intercept) attitudepol</span></span>
<span id="cb240-45"><a href="multilevel-models.html#cb240-45" tabindex="-1"></a><span class="co">#&gt; F1         241       -19.7</span></span>
<span id="cb240-46"><a href="multilevel-models.html#cb240-46" tabindex="-1"></a><span class="co">#&gt; F2         267       -19.7</span></span>
<span id="cb240-47"><a href="multilevel-models.html#cb240-47" tabindex="-1"></a><span class="co">#&gt; F3         260       -19.7</span></span>
<span id="cb240-48"><a href="multilevel-models.html#cb240-48" tabindex="-1"></a><span class="co">#&gt; M3         179       -19.7</span></span>
<span id="cb240-49"><a href="multilevel-models.html#cb240-49" tabindex="-1"></a><span class="co">#&gt; M4         155       -19.7</span></span>
<span id="cb240-50"><a href="multilevel-models.html#cb240-50" tabindex="-1"></a><span class="co">#&gt; M7         113       -19.7</span></span>
<span id="cb240-51"><a href="multilevel-models.html#cb240-51" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb240-52"><a href="multilevel-models.html#cb240-52" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;class&quot;)</span></span>
<span id="cb240-53"><a href="multilevel-models.html#cb240-53" tabindex="-1"></a><span class="co">#&gt; [1] &quot;coef.mer&quot;</span></span></code></pre></div>
<p>Let’s focus on the output for the random effects first:</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="multilevel-models.html#cb241-1" tabindex="-1"></a><span class="co"># Random effects:</span></span>
<span id="cb241-2"><a href="multilevel-models.html#cb241-2" tabindex="-1"></a><span class="co">#   Groups   Name       Variance Std.Dev.</span></span>
<span id="cb241-3"><a href="multilevel-models.html#cb241-3" tabindex="-1"></a><span class="co"># scenario (Intercept)  219     14.80   </span></span>
<span id="cb241-4"><a href="multilevel-models.html#cb241-4" tabindex="-1"></a><span class="co"># subject  (Intercept) 4015     63.36   </span></span>
<span id="cb241-5"><a href="multilevel-models.html#cb241-5" tabindex="-1"></a><span class="co"># Residual              646     25.42   </span></span>
<span id="cb241-6"><a href="multilevel-models.html#cb241-6" tabindex="-1"></a><span class="co"># Number of obs: 83, groups:  scenario, 7; subject, 6</span></span></code></pre></div>
<p>Have a look at the column standard deviation. This is a measure of how
much variability in the dependent measure there is due to scenarios and
subjects (our two random effects). You can see that scenario (“item”)
has much less variability than subject. Based on our boxplots from
above, where we saw more idiosyncratic differences between subjects than
between items, this is to be expected. Then, you see “Residual” which
stands for the variability that’s not due to either scenario or subject.
This is our “ε” again, the “random” deviations from the predicted values
that are not due to subjects and items. Here, this reflects the fact
that each and every utterance has some factors that affect pitch that
are outside of the purview of our experiment.</p>
<p>The fixed effects output mirrors the coefficient table that we
considered in tutorial 1 when we talked about the results of our linear
model analysis.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="multilevel-models.html#cb242-1" tabindex="-1"></a><span class="co"># Fixed effects:</span></span>
<span id="cb242-2"><a href="multilevel-models.html#cb242-2" tabindex="-1"></a><span class="co">#              Estimate  Std. Error t value</span></span>
<span id="cb242-3"><a href="multilevel-models.html#cb242-3" tabindex="-1"></a><span class="co"># (Intercept)  202.588     26.754   7.572</span></span>
<span id="cb242-4"><a href="multilevel-models.html#cb242-4" tabindex="-1"></a><span class="co"># attitudepol  -19.695      5.585  -3.527</span></span></code></pre></div>
<p>The coefficient “attitudepol” is the slope for the categorical effect of
politeness. Minus 19.695 means that to go from “informal” to “polite”,
you have to go down-19.695 Hz. In other words: pitch is lower in polite
speech than in informal speech,by about 20 Hz. Then, there’s a standard
error associated with this slope, and a tvalue, which is simply the
estimate (20 Hz) divided by the standard error (check this by performing
the calculation by hand).</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="multilevel-models.html#cb243-1" tabindex="-1"></a><span class="co"># Challenge 2 -------------------------------------------------------------</span></span>
<span id="cb243-2"><a href="multilevel-models.html#cb243-2" tabindex="-1"></a></span>
<span id="cb243-3"><a href="multilevel-models.html#cb243-3" tabindex="-1"></a><span class="co"># this intercept is especially weird. </span></span>
<span id="cb243-4"><a href="multilevel-models.html#cb243-4" tabindex="-1"></a><span class="co"># It’s 202.588 Hz … where does that value come</span></span>
<span id="cb243-5"><a href="multilevel-models.html#cb243-5" tabindex="-1"></a><span class="co"># from?</span></span>
<span id="cb243-6"><a href="multilevel-models.html#cb243-6" tabindex="-1"></a></span>
<span id="cb243-7"><a href="multilevel-models.html#cb243-7" tabindex="-1"></a></span>
<span id="cb243-8"><a href="multilevel-models.html#cb243-8" tabindex="-1"></a></span>
<span id="cb243-9"><a href="multilevel-models.html#cb243-9" tabindex="-1"></a>politeness.model <span class="ot">=</span> <span class="fu">lmer</span>(frequency <span class="sc">~</span> attitude <span class="sc">*</span></span>
<span id="cb243-10"><a href="multilevel-models.html#cb243-10" tabindex="-1"></a>                          gender <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span></span>
<span id="cb243-11"><a href="multilevel-models.html#cb243-11" tabindex="-1"></a>                          (<span class="dv">1</span><span class="sc">|</span>scenario), <span class="at">data=</span>df)</span>
<span id="cb243-12"><a href="multilevel-models.html#cb243-12" tabindex="-1"></a></span>
<span id="cb243-13"><a href="multilevel-models.html#cb243-13" tabindex="-1"></a><span class="fu">summary</span>(politeness.model)</span>
<span id="cb243-14"><a href="multilevel-models.html#cb243-14" tabindex="-1"></a><span class="co">#&gt; Linear mixed model fit by REML [&#39;lmerMod&#39;]</span></span>
<span id="cb243-15"><a href="multilevel-models.html#cb243-15" tabindex="-1"></a><span class="co">#&gt; Formula: frequency ~ attitude * gender + (1 | subject) + (1 | scenario)</span></span>
<span id="cb243-16"><a href="multilevel-models.html#cb243-16" tabindex="-1"></a><span class="co">#&gt;    Data: df</span></span>
<span id="cb243-17"><a href="multilevel-models.html#cb243-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb243-18"><a href="multilevel-models.html#cb243-18" tabindex="-1"></a><span class="co">#&gt; REML criterion at convergence: 767</span></span>
<span id="cb243-19"><a href="multilevel-models.html#cb243-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb243-20"><a href="multilevel-models.html#cb243-20" tabindex="-1"></a><span class="co">#&gt; Scaled residuals: </span></span>
<span id="cb243-21"><a href="multilevel-models.html#cb243-21" tabindex="-1"></a><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span id="cb243-22"><a href="multilevel-models.html#cb243-22" tabindex="-1"></a><span class="co">#&gt; -2.119 -0.560 -0.077  0.511  3.335 </span></span>
<span id="cb243-23"><a href="multilevel-models.html#cb243-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb243-24"><a href="multilevel-models.html#cb243-24" tabindex="-1"></a><span class="co">#&gt; Random effects:</span></span>
<span id="cb243-25"><a href="multilevel-models.html#cb243-25" tabindex="-1"></a><span class="co">#&gt;  Groups   Name        Variance Std.Dev.</span></span>
<span id="cb243-26"><a href="multilevel-models.html#cb243-26" tabindex="-1"></a><span class="co">#&gt;  scenario (Intercept) 218      14.8    </span></span>
<span id="cb243-27"><a href="multilevel-models.html#cb243-27" tabindex="-1"></a><span class="co">#&gt;  subject  (Intercept) 617      24.8    </span></span>
<span id="cb243-28"><a href="multilevel-models.html#cb243-28" tabindex="-1"></a><span class="co">#&gt;  Residual             637      25.2    </span></span>
<span id="cb243-29"><a href="multilevel-models.html#cb243-29" tabindex="-1"></a><span class="co">#&gt; Number of obs: 83, groups:  scenario, 7; subject, 6</span></span>
<span id="cb243-30"><a href="multilevel-models.html#cb243-30" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb243-31"><a href="multilevel-models.html#cb243-31" tabindex="-1"></a><span class="co">#&gt; Fixed effects:</span></span>
<span id="cb243-32"><a href="multilevel-models.html#cb243-32" tabindex="-1"></a><span class="co">#&gt;                     Estimate Std. Error t value</span></span>
<span id="cb243-33"><a href="multilevel-models.html#cb243-33" tabindex="-1"></a><span class="co">#&gt; (Intercept)           260.69      16.35   15.95</span></span>
<span id="cb243-34"><a href="multilevel-models.html#cb243-34" tabindex="-1"></a><span class="co">#&gt; attitudepol           -27.40       7.79   -3.52</span></span>
<span id="cb243-35"><a href="multilevel-models.html#cb243-35" tabindex="-1"></a><span class="co">#&gt; genderM              -116.20      21.73   -5.35</span></span>
<span id="cb243-36"><a href="multilevel-models.html#cb243-36" tabindex="-1"></a><span class="co">#&gt; attitudepol:genderM    15.57      11.10    1.40</span></span>
<span id="cb243-37"><a href="multilevel-models.html#cb243-37" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb243-38"><a href="multilevel-models.html#cb243-38" tabindex="-1"></a><span class="co">#&gt; Correlation of Fixed Effects:</span></span>
<span id="cb243-39"><a href="multilevel-models.html#cb243-39" tabindex="-1"></a><span class="co">#&gt;             (Intr) atttdp gendrM</span></span>
<span id="cb243-40"><a href="multilevel-models.html#cb243-40" tabindex="-1"></a><span class="co">#&gt; attitudepol -0.238              </span></span>
<span id="cb243-41"><a href="multilevel-models.html#cb243-41" tabindex="-1"></a><span class="co">#&gt; genderM     -0.665  0.179       </span></span>
<span id="cb243-42"><a href="multilevel-models.html#cb243-42" tabindex="-1"></a><span class="co">#&gt; atttdpl:gnM  0.167 -0.702 -0.252</span></span></code></pre></div>
<p>Note that compared to our earlier model without the fixed effect gender,
the variation that’s associated with the random effect “subject” dropped
considerably. This is because the variation that’s due to gender was
confounded with the variation that’s due to subject. The model didn’t
know about males and females, and so its predictions were relatively
more off, creating relatively larger residuals. Now that we have added
the effect of gender, we have shifted a considerable amount of the
variance that was previously in the random effects component
(differences between male and female individuals) to the fixed effects
component.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="multilevel-models.html#cb244-1" tabindex="-1"></a><span class="co"># Random effects:</span></span>
<span id="cb244-2"><a href="multilevel-models.html#cb244-2" tabindex="-1"></a><span class="co">#   Groups   Name        Variance Std.Dev.</span></span>
<span id="cb244-3"><a href="multilevel-models.html#cb244-3" tabindex="-1"></a><span class="co"># scenario (Intercept) 219.5    14.81   </span></span>
<span id="cb244-4"><a href="multilevel-models.html#cb244-4" tabindex="-1"></a><span class="co"># subject  (Intercept) 615.6    24.81   </span></span>
<span id="cb244-5"><a href="multilevel-models.html#cb244-5" tabindex="-1"></a><span class="co"># Residual             645.9    25.41   </span></span>
<span id="cb244-6"><a href="multilevel-models.html#cb244-6" tabindex="-1"></a><span class="co"># Number of obs: 83, groups:  scenario, 7; subject, 6</span></span></code></pre></div>
<p>We see that males and females differ by about 109 Hz. And the intercept
is now much higher (256.846 Hz), as it now represents the female
category (for the informal condition). The coefficient for the effect of
attitude didn’t change much.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="multilevel-models.html#cb245-1" tabindex="-1"></a></span>
<span id="cb245-2"><a href="multilevel-models.html#cb245-2" tabindex="-1"></a><span class="co"># Fixed effects:</span></span>
<span id="cb245-3"><a href="multilevel-models.html#cb245-3" tabindex="-1"></a><span class="co">#              Estimate Std. Error t value</span></span>
<span id="cb245-4"><a href="multilevel-models.html#cb245-4" tabindex="-1"></a><span class="co"># (Intercept)  256.846     16.116  15.938</span></span>
<span id="cb245-5"><a href="multilevel-models.html#cb245-5" tabindex="-1"></a><span class="co"># attitudepol  -19.721      5.584  -3.532</span></span>
<span id="cb245-6"><a href="multilevel-models.html#cb245-6" tabindex="-1"></a><span class="co"># genderM     -108.516     21.013  -5.164</span></span>
<span id="cb245-7"><a href="multilevel-models.html#cb245-7" tabindex="-1"></a></span>
<span id="cb245-8"><a href="multilevel-models.html#cb245-8" tabindex="-1"></a><span class="co"># Significance</span></span>
<span id="cb245-9"><a href="multilevel-models.html#cb245-9" tabindex="-1"></a></span>
<span id="cb245-10"><a href="multilevel-models.html#cb245-10" tabindex="-1"></a>politeness.null <span class="ot">=</span> <span class="fu">lmer</span>(frequency <span class="sc">~</span> gender <span class="sc">+</span></span>
<span id="cb245-11"><a href="multilevel-models.html#cb245-11" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>scenario), <span class="at">data=</span>df,</span>
<span id="cb245-12"><a href="multilevel-models.html#cb245-12" tabindex="-1"></a>                       <span class="at">REML=</span><span class="cn">FALSE</span>)</span>
<span id="cb245-13"><a href="multilevel-models.html#cb245-13" tabindex="-1"></a></span>
<span id="cb245-14"><a href="multilevel-models.html#cb245-14" tabindex="-1"></a>politeness.model <span class="ot">=</span> <span class="fu">lmer</span>(frequency <span class="sc">~</span> attitude <span class="sc">+</span></span>
<span id="cb245-15"><a href="multilevel-models.html#cb245-15" tabindex="-1"></a>                          gender <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>scenario),</span>
<span id="cb245-16"><a href="multilevel-models.html#cb245-16" tabindex="-1"></a>                        <span class="at">data=</span>df, <span class="at">REML=</span><span class="cn">FALSE</span>)</span>
<span id="cb245-17"><a href="multilevel-models.html#cb245-17" tabindex="-1"></a></span>
<span id="cb245-18"><a href="multilevel-models.html#cb245-18" tabindex="-1"></a><span class="fu">anova</span>(politeness.null,politeness.model)</span>
<span id="cb245-19"><a href="multilevel-models.html#cb245-19" tabindex="-1"></a><span class="co">#&gt; Data: df</span></span>
<span id="cb245-20"><a href="multilevel-models.html#cb245-20" tabindex="-1"></a><span class="co">#&gt; Models:</span></span>
<span id="cb245-21"><a href="multilevel-models.html#cb245-21" tabindex="-1"></a><span class="co">#&gt; politeness.null: frequency ~ gender + (1 | subject) + (1 | scenario)</span></span>
<span id="cb245-22"><a href="multilevel-models.html#cb245-22" tabindex="-1"></a><span class="co">#&gt; politeness.model: frequency ~ attitude + gender + (1 | subject) + (1 | scenario)</span></span>
<span id="cb245-23"><a href="multilevel-models.html#cb245-23" tabindex="-1"></a><span class="co">#&gt;                  npar AIC BIC logLik deviance Chisq Df Pr(&gt;Chisq)    </span></span>
<span id="cb245-24"><a href="multilevel-models.html#cb245-24" tabindex="-1"></a><span class="co">#&gt; politeness.null     5 817 829   -403      807                        </span></span>
<span id="cb245-25"><a href="multilevel-models.html#cb245-25" tabindex="-1"></a><span class="co">#&gt; politeness.model    6 807 822   -398      795  11.6  1    0.00065 ***</span></span>
<span id="cb245-26"><a href="multilevel-models.html#cb245-26" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb245-27"><a href="multilevel-models.html#cb245-27" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb245-28"><a href="multilevel-models.html#cb245-28" tabindex="-1"></a></span>
<span id="cb245-29"><a href="multilevel-models.html#cb245-29" tabindex="-1"></a><span class="fu">coef</span>(politeness.model)</span>
<span id="cb245-30"><a href="multilevel-models.html#cb245-30" tabindex="-1"></a><span class="co">#&gt; $scenario</span></span>
<span id="cb245-31"><a href="multilevel-models.html#cb245-31" tabindex="-1"></a><span class="co">#&gt;   (Intercept) attitudepol genderM</span></span>
<span id="cb245-32"><a href="multilevel-models.html#cb245-32" tabindex="-1"></a><span class="co">#&gt; 1         243       -19.7    -109</span></span>
<span id="cb245-33"><a href="multilevel-models.html#cb245-33" tabindex="-1"></a><span class="co">#&gt; 2         263       -19.7    -109</span></span>
<span id="cb245-34"><a href="multilevel-models.html#cb245-34" tabindex="-1"></a><span class="co">#&gt; 3         268       -19.7    -109</span></span>
<span id="cb245-35"><a href="multilevel-models.html#cb245-35" tabindex="-1"></a><span class="co">#&gt; 4         277       -19.7    -109</span></span>
<span id="cb245-36"><a href="multilevel-models.html#cb245-36" tabindex="-1"></a><span class="co">#&gt; 5         255       -19.7    -109</span></span>
<span id="cb245-37"><a href="multilevel-models.html#cb245-37" tabindex="-1"></a><span class="co">#&gt; 6         245       -19.7    -109</span></span>
<span id="cb245-38"><a href="multilevel-models.html#cb245-38" tabindex="-1"></a><span class="co">#&gt; 7         246       -19.7    -109</span></span>
<span id="cb245-39"><a href="multilevel-models.html#cb245-39" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb245-40"><a href="multilevel-models.html#cb245-40" tabindex="-1"></a><span class="co">#&gt; $subject</span></span>
<span id="cb245-41"><a href="multilevel-models.html#cb245-41" tabindex="-1"></a><span class="co">#&gt;    (Intercept) attitudepol genderM</span></span>
<span id="cb245-42"><a href="multilevel-models.html#cb245-42" tabindex="-1"></a><span class="co">#&gt; F1         243       -19.7    -109</span></span>
<span id="cb245-43"><a href="multilevel-models.html#cb245-43" tabindex="-1"></a><span class="co">#&gt; F2         267       -19.7    -109</span></span>
<span id="cb245-44"><a href="multilevel-models.html#cb245-44" tabindex="-1"></a><span class="co">#&gt; F3         260       -19.7    -109</span></span>
<span id="cb245-45"><a href="multilevel-models.html#cb245-45" tabindex="-1"></a><span class="co">#&gt; M3         284       -19.7    -109</span></span>
<span id="cb245-46"><a href="multilevel-models.html#cb245-46" tabindex="-1"></a><span class="co">#&gt; M4         262       -19.7    -109</span></span>
<span id="cb245-47"><a href="multilevel-models.html#cb245-47" tabindex="-1"></a><span class="co">#&gt; M7         224       -19.7    -109</span></span>
<span id="cb245-48"><a href="multilevel-models.html#cb245-48" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb245-49"><a href="multilevel-models.html#cb245-49" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;class&quot;)</span></span>
<span id="cb245-50"><a href="multilevel-models.html#cb245-50" tabindex="-1"></a><span class="co">#&gt; [1] &quot;coef.mer&quot;</span></span>
<span id="cb245-51"><a href="multilevel-models.html#cb245-51" tabindex="-1"></a></span>
<span id="cb245-52"><a href="multilevel-models.html#cb245-52" tabindex="-1"></a></span>
<span id="cb245-53"><a href="multilevel-models.html#cb245-53" tabindex="-1"></a>politeness.model <span class="ot">=</span> <span class="fu">lmer</span>(frequency <span class="sc">~</span> attitude <span class="sc">+</span></span>
<span id="cb245-54"><a href="multilevel-models.html#cb245-54" tabindex="-1"></a>                          gender <span class="sc">+</span> (<span class="dv">1</span><span class="sc">+</span>attitude<span class="sc">|</span>subject) <span class="sc">+</span></span>
<span id="cb245-55"><a href="multilevel-models.html#cb245-55" tabindex="-1"></a>                          (<span class="dv">1</span><span class="sc">+</span>attitude<span class="sc">|</span>scenario),</span>
<span id="cb245-56"><a href="multilevel-models.html#cb245-56" tabindex="-1"></a>                        <span class="at">data=</span>df,</span>
<span id="cb245-57"><a href="multilevel-models.html#cb245-57" tabindex="-1"></a>                        <span class="at">REML=</span><span class="cn">FALSE</span>)</span>
<span id="cb245-58"><a href="multilevel-models.html#cb245-58" tabindex="-1"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb245-59"><a href="multilevel-models.html#cb245-59" tabindex="-1"></a></span>
<span id="cb245-60"><a href="multilevel-models.html#cb245-60" tabindex="-1"></a></span>
<span id="cb245-61"><a href="multilevel-models.html#cb245-61" tabindex="-1"></a></span>
<span id="cb245-62"><a href="multilevel-models.html#cb245-62" tabindex="-1"></a>politeness.null <span class="ot">=</span> <span class="fu">lmer</span>(frequency <span class="sc">~</span> gender <span class="sc">+</span></span>
<span id="cb245-63"><a href="multilevel-models.html#cb245-63" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">+</span>attitude<span class="sc">|</span>subject) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">+</span>attitude<span class="sc">|</span>scenario),</span>
<span id="cb245-64"><a href="multilevel-models.html#cb245-64" tabindex="-1"></a>                       <span class="at">data=</span>df, <span class="at">REML=</span><span class="cn">FALSE</span>)</span>
<span id="cb245-65"><a href="multilevel-models.html#cb245-65" tabindex="-1"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span>
<span id="cb245-66"><a href="multilevel-models.html#cb245-66" tabindex="-1"></a></span>
<span id="cb245-67"><a href="multilevel-models.html#cb245-67" tabindex="-1"></a><span class="fu">anova</span>(politeness.null,politeness.model)</span>
<span id="cb245-68"><a href="multilevel-models.html#cb245-68" tabindex="-1"></a><span class="co">#&gt; Data: df</span></span>
<span id="cb245-69"><a href="multilevel-models.html#cb245-69" tabindex="-1"></a><span class="co">#&gt; Models:</span></span>
<span id="cb245-70"><a href="multilevel-models.html#cb245-70" tabindex="-1"></a><span class="co">#&gt; politeness.null: frequency ~ gender + (1 + attitude | subject) + (1 + attitude | scenario)</span></span>
<span id="cb245-71"><a href="multilevel-models.html#cb245-71" tabindex="-1"></a><span class="co">#&gt; politeness.model: frequency ~ attitude + gender + (1 + attitude | subject) + (1 + attitude | scenario)</span></span>
<span id="cb245-72"><a href="multilevel-models.html#cb245-72" tabindex="-1"></a><span class="co">#&gt;                  npar AIC BIC logLik deviance Chisq Df Pr(&gt;Chisq)   </span></span>
<span id="cb245-73"><a href="multilevel-models.html#cb245-73" tabindex="-1"></a><span class="co">#&gt; politeness.null     9 820 841   -401      802                       </span></span>
<span id="cb245-74"><a href="multilevel-models.html#cb245-74" tabindex="-1"></a><span class="co">#&gt; politeness.model   10 815 839   -397      795  6.71  1     0.0096 **</span></span>
<span id="cb245-75"><a href="multilevel-models.html#cb245-75" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb245-76"><a href="multilevel-models.html#cb245-76" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb245-77"><a href="multilevel-models.html#cb245-77" tabindex="-1"></a></span>
<span id="cb245-78"><a href="multilevel-models.html#cb245-78" tabindex="-1"></a>politeness.model<span class="ot">=</span><span class="fu">lmer</span>(frequency<span class="sc">~</span>attitude<span class="sc">+</span>gender<span class="sc">+</span>(<span class="dv">1</span><span class="sc">+</span>attitude<span class="sc">|</span>scenario), <span class="at">data =</span> df, <span class="at">REML =</span> F)</span>
<span id="cb245-79"><a href="multilevel-models.html#cb245-79" tabindex="-1"></a><span class="co">#&gt; boundary (singular) fit: see ?isSingular</span></span></code></pre></div>
<p><strong>Challenge 3</strong></p>
<p>Attempt to apply the mixed model to your own dataset. How many
predictors do you have? Is it appropriate? Why or why not.</p>
<p><strong>Challenge 4</strong></p>
<p>What is the intercept of your mixed model? What does it mean for your
data?</p>
<p><strong>Challenge 5</strong></p>
<p>Which predictor variables predict your dependent variable? How did you
determine that?</p>
</div>
</div>
</div>
<div id="solutions-3" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Solutions<a href="multilevel-models.html#solutions-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="challenge-1" class="section level3 hasAnchor" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Challenge 1<a href="multilevel-models.html#challenge-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>What happens if we leave out the “group” argument to aes()?</p>
<p>ggplot() only plots one boxplot.</p>
<p>Why?</p>
<p>The x = scenario only plots x on the x-axis, but geom_boxplot() needs
the additional group argument to plot the scenarios individually.
Otherwise, it groups all of them and plots them together.</p>
<p>How do we account for variation in scenario?</p>
<p>If we have random variation by item, then we need allow each item to
have a random intercept.</p>
</div>
<div id="challenge-2-1" class="section level3 hasAnchor" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Challenge 2<a href="multilevel-models.html#challenge-2-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you look back at the boxplot that we constructed earlier, you can see
that the value 202.588 Hz seems to fall halfway between males and
females (in the informal condition) – and this is indeed what this
intercept represents. It’s the average of our data for the informal
condition.</p>
</div>
<div id="challenge-3-1" class="section level3 hasAnchor" number="9.2.3">
<h3><span class="header-section-number">9.2.3</span> Challenge 3<a href="multilevel-models.html#challenge-3-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Attempt to apply the mixed model to your own dataset. How many
predictors do you have? Is it appropriate? Why or why not.</p>
<p>If your dataset has a repeated measures within a person, it is
appropriate. If you do not</p>
</div>
<div id="challenge-4-1" class="section level3 hasAnchor" number="9.2.4">
<h3><span class="header-section-number">9.2.4</span> Challenge 4<a href="multilevel-models.html#challenge-4-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>What is the intercept of your mixed model? What does it mean for your
data?</p>
<p>You should determine if your intercept is meaningful based on your
predictors</p>
</div>
<div id="challenge-5-1" class="section level3 hasAnchor" number="9.2.5">
<h3><span class="header-section-number">9.2.5</span> Challenge 5<a href="multilevel-models.html#challenge-5-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Which predictor variables predict your dependent variable? How did you
determine that?</p>
<p>Look at the significance tests, such as a p-value.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="rmarkdown.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://spencercastro.com/08_MultilevelModels.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
