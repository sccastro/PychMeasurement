<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Steps of Linear Models | Psychological Measurement in R</title>
  <meta name="description" content="As a modern Psychologist, we can no longer be purely theoretical hypothesis generators, experimentalists, statisticians, or clinicians; now we must strive to be methodologically sound, balance experimental design against convenient populations, keep up with the ever-changing landscape of statistical tests and their caveats, and learn rudimentary computer programming on top of that! Therefore we need a tool that balances the comprehensibility of human language with the flexibility to keep up with developing statistical methods and the power to analyze any dataset. Enter R, the open-source statistical computing and graphics language with a powerful Integrated Development Environment (the Rstudio IDE), a robust community of developers, data scientists, and experts (who respond to questions!), and too many reputable online resources to read in a lifetime. The impetus to learn something new on top of your ongoing research may be hard to summon, but this course is designed to integrate your ongoing research projects into mastering R, and to provide tools for streamlining projects in the future." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Steps of Linear Models | Psychological Measurement in R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://spencercastro.com" />
  <meta property="og:image" content="https://spencercastro.comimages/UPsychLogo.jpg" />
  <meta property="og:description" content="As a modern Psychologist, we can no longer be purely theoretical hypothesis generators, experimentalists, statisticians, or clinicians; now we must strive to be methodologically sound, balance experimental design against convenient populations, keep up with the ever-changing landscape of statistical tests and their caveats, and learn rudimentary computer programming on top of that! Therefore we need a tool that balances the comprehensibility of human language with the flexibility to keep up with developing statistical methods and the power to analyze any dataset. Enter R, the open-source statistical computing and graphics language with a powerful Integrated Development Environment (the Rstudio IDE), a robust community of developers, data scientists, and experts (who respond to questions!), and too many reputable online resources to read in a lifetime. The impetus to learn something new on top of your ongoing research may be hard to summon, but this course is designed to integrate your ongoing research projects into mastering R, and to provide tools for streamlining projects in the future." />
  <meta name="github-repo" content="sccastro/PsychMeasurement" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Steps of Linear Models | Psychological Measurement in R" />
  
  <meta name="twitter:description" content="As a modern Psychologist, we can no longer be purely theoretical hypothesis generators, experimentalists, statisticians, or clinicians; now we must strive to be methodologically sound, balance experimental design against convenient populations, keep up with the ever-changing landscape of statistical tests and their caveats, and learn rudimentary computer programming on top of that! Therefore we need a tool that balances the comprehensibility of human language with the flexibility to keep up with developing statistical methods and the power to analyze any dataset. Enter R, the open-source statistical computing and graphics language with a powerful Integrated Development Environment (the Rstudio IDE), a robust community of developers, data scientists, and experts (who respond to questions!), and too many reputable online resources to read in a lifetime. The impetus to learn something new on top of your ongoing research may be hard to summon, but this course is designed to integrate your ongoing research projects into mastering R, and to provide tools for streamlining projects in the future." />
  <meta name="twitter:image" content="https://spencercastro.comimages/UPsychLogo.jpg" />

<meta name="author" content="Spencer Castro" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-models.html"/>
<link rel="next" href="multilevel-models.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="class_book.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Psychological Measurement in R</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="syllabus.html"><a href="syllabus.html"><i class="fa fa-check"></i><b>1</b> Syllabus</a><ul>
<li class="chapter" data-level="1.1" data-path="syllabus.html"><a href="syllabus.html#course-overview"><i class="fa fa-check"></i><b>1.1</b> Course Overview</a></li>
<li class="chapter" data-level="1.2" data-path="syllabus.html"><a href="syllabus.html#learning-outcomes-course-objectives"><i class="fa fa-check"></i><b>1.2</b> Learning Outcomes &amp; Course Objectives</a></li>
<li class="chapter" data-level="1.3" data-path="syllabus.html"><a href="syllabus.html#course-format"><i class="fa fa-check"></i><b>1.3</b> Course Format</a></li>
<li class="chapter" data-level="1.4" data-path="syllabus.html"><a href="syllabus.html#evaluation-methodsassignments"><i class="fa fa-check"></i><b>1.4</b> Evaluation Methods/Assignments</a></li>
<li class="chapter" data-level="1.5" data-path="syllabus.html"><a href="syllabus.html#grading-policy"><i class="fa fa-check"></i><b>1.5</b> Grading Policy</a></li>
<li class="chapter" data-level="1.6" data-path="syllabus.html"><a href="syllabus.html#student-rights-and-responsibilities"><i class="fa fa-check"></i><b>1.6</b> Student Rights and Responsibilities</a></li>
<li class="chapter" data-level="1.7" data-path="syllabus.html"><a href="syllabus.html#department-of-psychology-undergraduate-academic-misconduct-policy"><i class="fa fa-check"></i><b>1.7</b> Department of Psychology Undergraduate Academic Misconduct Policy</a></li>
<li class="chapter" data-level="1.8" data-path="syllabus.html"><a href="syllabus.html#course-policies"><i class="fa fa-check"></i><b>1.8</b> Course Policies</a></li>
<li class="chapter" data-level="1.9" data-path="syllabus.html"><a href="syllabus.html#university-attendance-requirements"><i class="fa fa-check"></i><b>1.9</b> University Attendance Requirements</a></li>
<li class="chapter" data-level="1.10" data-path="syllabus.html"><a href="syllabus.html#student-support-accommodations"><i class="fa fa-check"></i><b>1.10</b> Student Support &amp; Accommodations</a></li>
<li class="chapter" data-level="1.11" data-path="syllabus.html"><a href="syllabus.html#academic-calendar"><i class="fa fa-check"></i><b>1.11</b> Academic Calendar</a></li>
<li class="chapter" data-level="1.12" data-path="syllabus.html"><a href="syllabus.html#course-schedule"><i class="fa fa-check"></i><b>1.12</b> Course Schedule</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#baser-walkthrough"><i class="fa fa-check"></i>BaseR walkthrough</a></li>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#help"><i class="fa fa-check"></i><b>2.1</b> Help</a></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#vectors"><i class="fa fa-check"></i><b>2.2</b> VECTORS</a></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#programming"><i class="fa fa-check"></i><b>2.3</b> PROGRAMMING</a><ul>
<li class="chapter" data-level="2.3.1" data-path="introduction.html"><a href="introduction.html#for-loop"><i class="fa fa-check"></i><b>2.3.1</b> For loop</a></li>
<li class="chapter" data-level="2.3.2" data-path="introduction.html"><a href="introduction.html#while-loop"><i class="fa fa-check"></i><b>2.3.2</b> While loop</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="introduction.html"><a href="introduction.html#assignment-1"><i class="fa fa-check"></i><b>2.4</b> Assignment 1</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i><b>3</b> Importing Data</a></li>
<li class="chapter" data-level="" data-path="reading-files-into-r.html"><a href="reading-files-into-r.html"><i class="fa fa-check"></i>Reading files into R</a><ul>
<li class="chapter" data-level="3.1" data-path="reading-files-into-r.html"><a href="reading-files-into-r.html#whats-a-tibble"><i class="fa fa-check"></i><b>3.1</b> What’s a tibble?</a></li>
<li class="chapter" data-level="3.2" data-path="reading-files-into-r.html"><a href="reading-files-into-r.html#save-your-dataset"><i class="fa fa-check"></i><b>3.2</b> Save your dataset:</a></li>
<li class="chapter" data-level="3.3" data-path="reading-files-into-r.html"><a href="reading-files-into-r.html#cleaning-your-data-file"><i class="fa fa-check"></i><b>3.3</b> Cleaning your data file</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>4</b> Data Transformation</a><ul>
<li class="chapter" data-level="" data-path="data-transformation.html"><a href="data-transformation.html#data-transformation-with-dplyr"><i class="fa fa-check"></i>Data Transformation with Dplyr</a></li>
<li class="chapter" data-level="4.1" data-path="data-transformation.html"><a href="data-transformation.html#get-a-dataset-from-your-.rdata-file"><i class="fa fa-check"></i><b>4.1</b> Get a dataset from your .RData file</a></li>
<li class="chapter" data-level="4.2" data-path="data-transformation.html"><a href="data-transformation.html#introduction-to-the-pipe"><i class="fa fa-check"></i><b>4.2</b> Introduction to “The Pipe”</a></li>
<li class="chapter" data-level="4.3" data-path="data-transformation.html"><a href="data-transformation.html#aside-on-the-apply-family"><i class="fa fa-check"></i><b>4.3</b> Aside on the apply family</a></li>
<li class="chapter" data-level="4.4" data-path="data-transformation.html"><a href="data-transformation.html#solutions-to-challenges"><i class="fa fa-check"></i><b>4.4</b> Solutions to Challenges</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-transformation-day-2.html"><a href="data-transformation-day-2.html"><i class="fa fa-check"></i><b>5</b> Data Transformation Day 2</a><ul>
<li class="chapter" data-level="5.1" data-path="data-transformation-day-2.html"><a href="data-transformation-day-2.html#rcolorbrewer"><i class="fa fa-check"></i><b>5.1</b> RcolorBrewer</a></li>
<li class="chapter" data-level="5.2" data-path="data-transformation-day-2.html"><a href="data-transformation-day-2.html#modifying-factor-levels"><i class="fa fa-check"></i><b>5.2</b> Modifying Factor Levels</a></li>
<li class="chapter" data-level="5.3" data-path="data-transformation-day-2.html"><a href="data-transformation-day-2.html#play-time"><i class="fa fa-check"></i><b>5.3</b> Play time</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="visualization-with-ggplot2.html"><a href="visualization-with-ggplot2.html"><i class="fa fa-check"></i><b>6</b> Visualization with ggplot2</a><ul>
<li class="chapter" data-level="6.1" data-path="visualization-with-ggplot2.html"><a href="visualization-with-ggplot2.html#statistical-transformations"><i class="fa fa-check"></i><b>6.1</b> Statistical Transformations</a></li>
<li class="chapter" data-level="6.2" data-path="visualization-with-ggplot2.html"><a href="visualization-with-ggplot2.html#changing-the-position"><i class="fa fa-check"></i><b>6.2</b> Changing the position</a></li>
<li class="chapter" data-level="6.3" data-path="visualization-with-ggplot2.html"><a href="visualization-with-ggplot2.html#coordinates"><i class="fa fa-check"></i><b>6.3</b> Coordinates</a><ul>
<li class="chapter" data-level="6.3.1" data-path="visualization-with-ggplot2.html"><a href="visualization-with-ggplot2.html#plot-maps-if-you-want"><i class="fa fa-check"></i><b>6.3.1</b> Plot maps if you want</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html"><i class="fa fa-check"></i><b>7</b> Introduction to Statistics</a><ul>
<li class="chapter" data-level="7.0.1" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#descriptive-stats"><i class="fa fa-check"></i><b>7.0.1</b> Descriptive Stats</a></li>
<li class="chapter" data-level="7.0.2" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>7.0.2</b> Measures of Central Tendency</a></li>
<li class="chapter" data-level="7.0.3" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#measures-of-variability"><i class="fa fa-check"></i><b>7.0.3</b> Measures of Variability</a></li>
<li class="chapter" data-level="7.1" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#clinical-trial-example"><i class="fa fa-check"></i><b>7.1</b> Clinical Trial Example</a><ul>
<li class="chapter" data-level="7.1.1" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#chi-square-goodness-of-fit-test-pearson-1900-review"><i class="fa fa-check"></i><b>7.1.1</b> Chi Square goodness-of-fit test (Pearson, 1900) Review</a></li>
<li class="chapter" data-level="7.1.2" data-path="introduction-to-statistics.html"><a href="introduction-to-statistics.html#chi-square-test-of-independence"><i class="fa fa-check"></i><b>7.1.2</b> Chi-square test of independence</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>8</b> Linear Models</a></li>
<li class="chapter" data-level="" data-path="steps-of-linear-models.html"><a href="steps-of-linear-models.html"><i class="fa fa-check"></i>Steps of Linear Models</a><ul>
<li class="chapter" data-level="8.1" data-path="steps-of-linear-models.html"><a href="steps-of-linear-models.html#step-1.-get-your-data"><i class="fa fa-check"></i><b>8.1</b> Step 1. Get your data</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="multilevel-models.html"><a href="multilevel-models.html"><i class="fa fa-check"></i><b>9</b> Multilevel Models</a><ul>
<li class="chapter" data-level="9.0.1" data-path="multilevel-models.html"><a href="multilevel-models.html#mixed-models-in-r"><i class="fa fa-check"></i><b>9.0.1</b> Mixed models in R</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Psychological Measurement in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="steps-of-linear-models" class="section level1 unnumbered">
<h1>Steps of Linear Models</h1>
<div id="step-1.-get-your-data" class="section level2">
<h2><span class="header-section-number">8.1</span> Step 1. Get your data</h2>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb216-1" data-line-number="1">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">cbind</span>(<span class="kw">cbind</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">1</span>), <span class="co">#cbind (column bind) a seq() (sequence) from 1 to 6 by 1</span></a>
<a class="sourceLine" id="cb216-2" data-line-number="2">            <span class="kw">sort</span>(<span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;female&quot;</span>,<span class="st">&quot;male&quot;</span>),<span class="dv">3</span>)), <span class="co">#Next column: male and female sorted for 3 of each (see ?rep, ?sort)</span></a>
<a class="sourceLine" id="cb216-3" data-line-number="3">            <span class="kw">c</span>(<span class="dv">233</span>,<span class="dv">204</span>,<span class="dv">242</span>,<span class="dv">130</span>,<span class="dv">112</span>,<span class="dv">142</span>)))); <span class="kw">colnames</span>(df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Subject&quot;</span>,<span class="st">&quot;Sex&quot;</span>, <span class="st">&quot;Voice.Pitch&quot;</span>) <span class="co">#pitches (number)</span></a>
<a class="sourceLine" id="cb216-4" data-line-number="4">            <span class="co">#in Hz, also see the ; use for R and ?colnames</span></a></code></pre></div>
<p>OR</p>
<p>create two vectors…</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb217-1" data-line-number="1">pitch =<span class="st"> </span><span class="kw">c</span>(<span class="dv">233</span>,<span class="dv">204</span>,<span class="dv">242</span>,<span class="dv">130</span>,<span class="dv">112</span>,<span class="dv">142</span>) <span class="co">#You can use the &quot;=&quot; assignment operator, but it&#39;s not R-like</span></a>
<a class="sourceLine" id="cb217-2" data-line-number="2">sex =<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;female&quot;</span>,<span class="dv">3</span>),<span class="kw">rep</span>(<span class="st">&quot;male&quot;</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb217-3" data-line-number="3"></a>
<a class="sourceLine" id="cb217-4" data-line-number="4">my.df =<span class="st"> </span><span class="kw">data.frame</span>(sex,pitch) <span class="co">#data.frame makes the vector names column names</span></a>
<a class="sourceLine" id="cb217-5" data-line-number="5">my.df</a>
<a class="sourceLine" id="cb217-6" data-line-number="6"><span class="co">#&gt;      sex pitch</span></a>
<a class="sourceLine" id="cb217-7" data-line-number="7"><span class="co">#&gt; 1 female   233</span></a>
<a class="sourceLine" id="cb217-8" data-line-number="8"><span class="co">#&gt; 2 female   204</span></a>
<a class="sourceLine" id="cb217-9" data-line-number="9"><span class="co">#&gt; 3 female   242</span></a>
<a class="sourceLine" id="cb217-10" data-line-number="10"><span class="co">#&gt; 4   male   130</span></a>
<a class="sourceLine" id="cb217-11" data-line-number="11"><span class="co">#&gt; 5   male   112</span></a>
<a class="sourceLine" id="cb217-12" data-line-number="12"><span class="co">#&gt; 6   male   142</span></a></code></pre></div>
<p>O.k., now we’ll proceed with the linear model. We take our formula above and feed it into the lm() function … except that we omit the “ε” term, because the linear model function doesn’t need you to specify this.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb218-1" data-line-number="1">xmdl =<span class="st"> </span><span class="kw">lm</span>(pitch <span class="op">~</span><span class="st"> </span>sex, my.df)   <span class="co">#The arguments are:</span></a>
<a class="sourceLine" id="cb218-2" data-line-number="2"><span class="co"># lm(formula = DV by IV,data = my.df)</span></a>
<a class="sourceLine" id="cb218-3" data-line-number="3"></a>
<a class="sourceLine" id="cb218-4" data-line-number="4"><span class="kw">summary</span>(xmdl)</a>
<a class="sourceLine" id="cb218-5" data-line-number="5"></a>
<a class="sourceLine" id="cb218-6" data-line-number="6"><span class="co"># Multiple R-squared:  0.921,   Adjusted R-squared:  0.9012 </span></a>
<a class="sourceLine" id="cb218-7" data-line-number="7"></a>
<a class="sourceLine" id="cb218-8" data-line-number="8"><span class="co"># “Multiple R-Squared”. This    </span></a>
<a class="sourceLine" id="cb218-9" data-line-number="9"><span class="co"># refers     to  the     statistic   R2 which    is  a   measure     of “variance    explained”  or  if  you    </span></a>
<a class="sourceLine" id="cb218-10" data-line-number="10"><span class="co"># prefer    less    causal  language,   it  is  a   measure of  “variance   accounted   for”.   R2 values   </span></a>
<a class="sourceLine" id="cb218-11" data-line-number="11"><span class="co"># range from    0   to  1.  </span></a>
<a class="sourceLine" id="cb218-12" data-line-number="12"></a>
<a class="sourceLine" id="cb218-13" data-line-number="13"><span class="co">#...92.1%   of  the stuff   that’s  happening   in  our dataset is  “explained” by  </span></a>
<a class="sourceLine" id="cb218-14" data-line-number="14"><span class="co"># our   model.</span></a>
<a class="sourceLine" id="cb218-15" data-line-number="15"></a>
<a class="sourceLine" id="cb218-16" data-line-number="16"><span class="co"># In     this   case,   because we  have    only    one  thing  in  our model   doing    the    </span></a>
<a class="sourceLine" id="cb218-17" data-line-number="17"><span class="co"># explaining    (the    fixed   effect  “sex”), the R2 reflects how much    variance in our data    is  </span></a>
<a class="sourceLine" id="cb218-18" data-line-number="18"><span class="co"># accounted for by  differences between males   and females.</span></a>
<a class="sourceLine" id="cb218-19" data-line-number="19"></a>
<a class="sourceLine" id="cb218-20" data-line-number="20"></a>
<a class="sourceLine" id="cb218-21" data-line-number="21"></a>
<a class="sourceLine" id="cb218-22" data-line-number="22"><span class="co"># Challenge 1 -------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb218-23" data-line-number="23"></a>
<a class="sourceLine" id="cb218-24" data-line-number="24"><span class="co">#Pick one dependent variable and one independent variable in your data.frame</span></a>
<a class="sourceLine" id="cb218-25" data-line-number="25"><span class="co">#(It doesn&#39;t really need to make sense for now, just that you set it up and run it.)</span></a>
<a class="sourceLine" id="cb218-26" data-line-number="26"><span class="co">#Replace the variables with your own...</span></a>
<a class="sourceLine" id="cb218-27" data-line-number="27">newdf &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb218-28" data-line-number="28"><span class="st">  </span><span class="kw">select</span>(Sex,Voice.Pitch) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb218-29" data-line-number="29"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Voice.Pitch =</span> <span class="kw">as.numeric</span>(<span class="kw">as.character</span>(Voice.Pitch)))</a>
<a class="sourceLine" id="cb218-30" data-line-number="30"></a>
<a class="sourceLine" id="cb218-31" data-line-number="31"><span class="co">#Set up your lm (linear model) object</span></a>
<a class="sourceLine" id="cb218-32" data-line-number="32">my.lm &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> Voice.Pitch <span class="op">~</span><span class="st"> </span>Sex, <span class="dt">data =</span> newdf)</a>
<a class="sourceLine" id="cb218-33" data-line-number="33"></a>
<a class="sourceLine" id="cb218-34" data-line-number="34"><span class="kw">summary</span>(my.lm)</a>
<a class="sourceLine" id="cb218-35" data-line-number="35"></a>
<a class="sourceLine" id="cb218-36" data-line-number="36"><span class="co">#Now back to the tutorial!</span></a>
<a class="sourceLine" id="cb218-37" data-line-number="37"></a>
<a class="sourceLine" id="cb218-38" data-line-number="38"></a>
<a class="sourceLine" id="cb218-39" data-line-number="39"><span class="co"># Coefficients:</span></a>
<a class="sourceLine" id="cb218-40" data-line-number="40"><span class="co">#   Estimate Std. Error t value Pr(&gt;|t|)    </span></a>
<a class="sourceLine" id="cb218-41" data-line-number="41"><span class="co">#   (Intercept)   226.33      10.18  22.224 2.43e-05 ***</span></a>
<a class="sourceLine" id="cb218-42" data-line-number="42"><span class="co">#   sexmale       -98.33      14.40  -6.827  0.00241 ** </span></a>
<a class="sourceLine" id="cb218-43" data-line-number="43"></a>
<a class="sourceLine" id="cb218-44" data-line-number="44"></a>
<a class="sourceLine" id="cb218-45" data-line-number="45"><span class="co"># But   why does    it  say “sexmale” rather    than    just    “sex”,  which   is  how we  named   our </span></a>
<a class="sourceLine" id="cb218-46" data-line-number="46"><span class="co"># fixed effect? And where   did the females go? If  you look    at  the estimate    in  the row </span></a>
<a class="sourceLine" id="cb218-47" data-line-number="47"><span class="co"># that  starts  with    “(Intercept)”,  you’ll  see that    the value   is  226.33 Hz.  This    looks   like    </span></a>
<a class="sourceLine" id="cb218-48" data-line-number="48"><span class="co"># it     could   be  the     estimated   mean    of  the     female  voice   pitches.    If  you     type    the    </span></a>
<a class="sourceLine" id="cb218-49" data-line-number="49"><span class="co"># following…</span></a>
<a class="sourceLine" id="cb218-50" data-line-number="50"></a>
<a class="sourceLine" id="cb218-51" data-line-number="51"><span class="kw">mean</span>(my.df[my.df<span class="op">$</span>sex<span class="op">==</span><span class="st">&quot;female&quot;</span>,]<span class="op">$</span>pitch)</a>
<a class="sourceLine" id="cb218-52" data-line-number="52"><span class="kw">mean</span>(my.df[my.df<span class="op">$</span>sex<span class="op">==</span><span class="st">&quot;male&quot;</span>,]<span class="op">$</span>pitch)</a>
<a class="sourceLine" id="cb218-53" data-line-number="53"></a>
<a class="sourceLine" id="cb218-54" data-line-number="54"><span class="co"># … you’ll  get the mean    of  female  voice   pitch   values, and you’ll  see that    this    value   is  </span></a>
<a class="sourceLine" id="cb218-55" data-line-number="55"><span class="co"># very  similar to  the estimate    value   in  the “(Intercept)”   column.</span></a>
<a class="sourceLine" id="cb218-56" data-line-number="56"><span class="kw">scatter.smooth</span>(<span class="dt">x =</span> my.df<span class="op">$</span>sex, my.df<span class="op">$</span>pitch,<span class="dt">ylab =</span> <span class="st">&quot;Pitch (Hz)&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;Sex&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">75</span>,<span class="dv">300</span>))</a>
<a class="sourceLine" id="cb218-57" data-line-number="57"></a>
<a class="sourceLine" id="cb218-58" data-line-number="58"><span class="kw">plot</span>(pitch<span class="op">~</span>sex, my.df)</a>
<a class="sourceLine" id="cb218-59" data-line-number="59"></a>
<a class="sourceLine" id="cb218-60" data-line-number="60"></a>
<a class="sourceLine" id="cb218-61" data-line-number="61"><span class="co">#Or with ggplot</span></a>
<a class="sourceLine" id="cb218-62" data-line-number="62"><span class="kw">coef</span>(xmdl)</a>
<a class="sourceLine" id="cb218-63" data-line-number="63"></a>
<a class="sourceLine" id="cb218-64" data-line-number="64"><span class="kw">require</span>(forcats)</a>
<a class="sourceLine" id="cb218-65" data-line-number="65">my.df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb218-66" data-line-number="66"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sex =</span> <span class="kw">fct_recode</span>(sex, <span class="st">&quot;0&quot;</span> =<span class="st"> &quot;female&quot;</span>, <span class="st">&quot;1&quot;</span> =<span class="st"> &quot;male&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb218-67" data-line-number="67"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sex =</span> <span class="kw">as.numeric</span>(<span class="kw">as.character</span>(sex))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb218-68" data-line-number="68"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span> sex,<span class="dt">y=</span>pitch)) <span class="op">+</span></a>
<a class="sourceLine" id="cb218-69" data-line-number="69"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb218-70" data-line-number="70"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="kw">coef</span>(xmdl)[<span class="dv">1</span>],<span class="dt">slope =</span> <span class="kw">coef</span>(xmdl)[<span class="dv">2</span>]) <span class="op">+</span></a>
<a class="sourceLine" id="cb218-71" data-line-number="71"><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span>.<span class="dv">5</span>,<span class="fl">1.5</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">300</span>))</a>
<a class="sourceLine" id="cb218-72" data-line-number="72">  </a>
<a class="sourceLine" id="cb218-73" data-line-number="73"></a>
<a class="sourceLine" id="cb218-74" data-line-number="74"></a>
<a class="sourceLine" id="cb218-75" data-line-number="75"><span class="co"># Challenge 2 -------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb218-76" data-line-number="76"></a>
<a class="sourceLine" id="cb218-77" data-line-number="77"><span class="co">#Why did I have to go through all this trouble of getting the slope and intercept,</span></a>
<a class="sourceLine" id="cb218-78" data-line-number="78"><span class="co">#and then changing Sex from a categorical factor to a numerical continuous variable?</span></a>
<a class="sourceLine" id="cb218-79" data-line-number="79"></a>
<a class="sourceLine" id="cb218-80" data-line-number="80"><span class="co">#Explain the geom_abline call.</span></a>
<a class="sourceLine" id="cb218-81" data-line-number="81"></a>
<a class="sourceLine" id="cb218-82" data-line-number="82"><span class="co">#What happens if I remove the as.character() from the mutate argument on line 90?</span></a>
<a class="sourceLine" id="cb218-83" data-line-number="83"></a>
<a class="sourceLine" id="cb218-84" data-line-number="84">my.df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb218-85" data-line-number="85"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sex =</span> <span class="kw">fct_recode</span>(sex, <span class="st">&quot;0&quot;</span> =<span class="st"> &quot;female&quot;</span>, <span class="st">&quot;1&quot;</span> =<span class="st"> &quot;male&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb218-86" data-line-number="86"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sex =</span> <span class="kw">as.numeric</span>(<span class="kw">as.character</span>(sex))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb218-87" data-line-number="87"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span> sex,<span class="dt">y=</span>pitch)) <span class="op">+</span></a>
<a class="sourceLine" id="cb218-88" data-line-number="88"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb218-89" data-line-number="89"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="kw">coef</span>(xmdl)[<span class="dv">1</span>],<span class="dt">slope =</span> <span class="kw">coef</span>(xmdl)[<span class="dv">2</span>]) <span class="op">+</span></a>
<a class="sourceLine" id="cb218-90" data-line-number="90"><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span>.<span class="dv">5</span>,<span class="fl">1.5</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">300</span>))</a>
<a class="sourceLine" id="cb218-91" data-line-number="91"></a>
<a class="sourceLine" id="cb218-92" data-line-number="92"></a>
<a class="sourceLine" id="cb218-93" data-line-number="93"><span class="co"># Challenge 3 -------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb218-94" data-line-number="94"></a>
<a class="sourceLine" id="cb218-95" data-line-number="95"><span class="co">#How does coord_cartesian() work? Does it transform any of the stats performed?</span></a>
<a class="sourceLine" id="cb218-96" data-line-number="96"></a>
<a class="sourceLine" id="cb218-97" data-line-number="97">my.df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb218-98" data-line-number="98"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sex =</span> <span class="kw">fct_recode</span>(sex, <span class="st">&quot;0&quot;</span> =<span class="st"> &quot;female&quot;</span>, <span class="st">&quot;1&quot;</span> =<span class="st"> &quot;male&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb218-99" data-line-number="99"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sex =</span> <span class="kw">as.numeric</span>(<span class="kw">as.character</span>(sex))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb218-100" data-line-number="100"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span> sex,<span class="dt">y=</span>pitch)) <span class="op">+</span></a>
<a class="sourceLine" id="cb218-101" data-line-number="101"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb218-102" data-line-number="102"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="kw">coef</span>(xmdl)[<span class="dv">1</span>],<span class="dt">slope =</span> <span class="kw">coef</span>(xmdl)[<span class="dv">2</span>]) <span class="op">+</span></a>
<a class="sourceLine" id="cb218-103" data-line-number="103"><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span>.<span class="dv">5</span>,<span class="fl">1.5</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">300</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb218-104" data-line-number="104"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>), <span class="dt">linetype =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">.7</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb218-105" data-line-number="105"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>), <span class="dt">linetype =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">.7</span>)</a>
<a class="sourceLine" id="cb218-106" data-line-number="106"></a>
<a class="sourceLine" id="cb218-107" data-line-number="107"></a>
<a class="sourceLine" id="cb218-108" data-line-number="108"></a>
<a class="sourceLine" id="cb218-109" data-line-number="109"><span class="co"># Challenge 4 -------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb218-110" data-line-number="110"></a>
<a class="sourceLine" id="cb218-111" data-line-number="111"><span class="co"># Can you put the labels &quot;female&quot; and &quot;male&quot; back on the x-axis?</span></a>
<a class="sourceLine" id="cb218-112" data-line-number="112"></a>
<a class="sourceLine" id="cb218-113" data-line-number="113"></a>
<a class="sourceLine" id="cb218-114" data-line-number="114"><span class="co"># Hint: Try scale_x_...</span></a>
<a class="sourceLine" id="cb218-115" data-line-number="115"></a>
<a class="sourceLine" id="cb218-116" data-line-number="116">my.df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb218-117" data-line-number="117"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sex =</span> <span class="kw">fct_recode</span>(sex, <span class="st">&quot;0&quot;</span> =<span class="st"> &quot;female&quot;</span>, <span class="st">&quot;1&quot;</span> =<span class="st"> &quot;male&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb218-118" data-line-number="118"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sex =</span> <span class="kw">as.numeric</span>(<span class="kw">as.character</span>(sex))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb218-119" data-line-number="119"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span> sex,<span class="dt">y=</span>pitch)) <span class="op">+</span></a>
<a class="sourceLine" id="cb218-120" data-line-number="120"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb218-121" data-line-number="121"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="kw">coef</span>(xmdl)[<span class="dv">1</span>],<span class="dt">slope =</span> <span class="kw">coef</span>(xmdl)[<span class="dv">2</span>]) <span class="op">+</span></a>
<a class="sourceLine" id="cb218-122" data-line-number="122"><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span>.<span class="dv">5</span>,<span class="fl">1.5</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">300</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb218-123" data-line-number="123"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>), <span class="dt">linetype =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">.7</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb218-124" data-line-number="124"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>), <span class="dt">linetype =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">.7</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb218-125" data-line-number="125"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;female&quot;</span>,<span class="st">&quot;male&quot;</span>))</a>
<a class="sourceLine" id="cb218-126" data-line-number="126"></a>
<a class="sourceLine" id="cb218-127" data-line-number="127"></a>
<a class="sourceLine" id="cb218-128" data-line-number="128"><span class="co"># Now back to the tutorial.</span></a>
<a class="sourceLine" id="cb218-129" data-line-number="129"></a>
<a class="sourceLine" id="cb218-130" data-line-number="130"><span class="co"># Advantages of thinking of categorical things as slopes.</span></a>
<a class="sourceLine" id="cb218-131" data-line-number="131"><span class="co"># It transfers to thinking about non-categorial things as slopes.</span></a>
<a class="sourceLine" id="cb218-132" data-line-number="132"></a>
<a class="sourceLine" id="cb218-133" data-line-number="133">age =<span class="st"> </span><span class="kw">c</span>(<span class="dv">14</span>,<span class="dv">23</span>,<span class="dv">35</span>,<span class="dv">48</span>,<span class="dv">52</span>,<span class="dv">67</span>)</a>
<a class="sourceLine" id="cb218-134" data-line-number="134">pitch =<span class="st"> </span><span class="kw">c</span>(<span class="dv">252</span>,<span class="dv">244</span>,<span class="dv">240</span>,<span class="dv">233</span>,<span class="dv">212</span>,<span class="dv">204</span>)</a>
<a class="sourceLine" id="cb218-135" data-line-number="135">my.df =<span class="st"> </span><span class="kw">data.frame</span>(age,pitch)</a>
<a class="sourceLine" id="cb218-136" data-line-number="136">xmdl =<span class="st"> </span><span class="kw">lm</span>(pitch <span class="op">~</span><span class="st"> </span>age, my.df)</a>
<a class="sourceLine" id="cb218-137" data-line-number="137"><span class="kw">summary</span>(xmdl)</a>
<a class="sourceLine" id="cb218-138" data-line-number="138"></a>
<a class="sourceLine" id="cb218-139" data-line-number="139"></a>
<a class="sourceLine" id="cb218-140" data-line-number="140"></a>
<a class="sourceLine" id="cb218-141" data-line-number="141"><span class="co"># Challenge 5 -------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb218-142" data-line-number="142"></a>
<a class="sourceLine" id="cb218-143" data-line-number="143"><span class="co"># Plot Voice Pitch by Age with a trend line.</span></a>
<a class="sourceLine" id="cb218-144" data-line-number="144"></a>
<a class="sourceLine" id="cb218-145" data-line-number="145"></a>
<a class="sourceLine" id="cb218-146" data-line-number="146"></a>
<a class="sourceLine" id="cb218-147" data-line-number="147"></a>
<a class="sourceLine" id="cb218-148" data-line-number="148"></a>
<a class="sourceLine" id="cb218-149" data-line-number="149"><span class="co"># Coefficients:</span></a>
<a class="sourceLine" id="cb218-150" data-line-number="150"><span class="co">#   Estimate Std. Error t value Pr(&gt;|t|)    </span></a>
<a class="sourceLine" id="cb218-151" data-line-number="151"><span class="co">#   (Intercept) 267.0765     6.8522   38.98 2.59e-06 ***</span></a>
<a class="sourceLine" id="cb218-152" data-line-number="152"><span class="co">#   age          -0.9099     0.1569   -5.80  0.00439 ** </span></a>
<a class="sourceLine" id="cb218-153" data-line-number="153"></a>
<a class="sourceLine" id="cb218-154" data-line-number="154"><span class="co">#So how does age relate to voice pitch?</span></a>
<a class="sourceLine" id="cb218-155" data-line-number="155"></a>
<a class="sourceLine" id="cb218-156" data-line-number="156"></a>
<a class="sourceLine" id="cb218-157" data-line-number="157"></a>
<a class="sourceLine" id="cb218-158" data-line-number="158"><span class="co"># Meaningful and meaningless intercepts. How can we make the intercept</span></a>
<a class="sourceLine" id="cb218-159" data-line-number="159"><span class="co"># age = 0 more meaningful?We can center on the average age of our sample...</span></a>
<a class="sourceLine" id="cb218-160" data-line-number="160"></a>
<a class="sourceLine" id="cb218-161" data-line-number="161">my.df<span class="op">$</span>age.c =<span class="st"> </span>my.df<span class="op">$</span>age <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(my.df<span class="op">$</span>age)</a>
<a class="sourceLine" id="cb218-162" data-line-number="162">xmdl =<span class="st"> </span><span class="kw">lm</span>(pitch <span class="op">~</span><span class="st"> </span>age.c, my.df)</a>
<a class="sourceLine" id="cb218-163" data-line-number="163"><span class="kw">summary</span>(xmdl)</a>
<a class="sourceLine" id="cb218-164" data-line-number="164"></a>
<a class="sourceLine" id="cb218-165" data-line-number="165"><span class="co"># Coefficients:</span></a>
<a class="sourceLine" id="cb218-166" data-line-number="166"><span class="co">#   Estimate Std. Error t value Pr(&gt;|t|)    </span></a>
<a class="sourceLine" id="cb218-167" data-line-number="167"><span class="co">#   (Intercept) 230.8333     2.8113   82.11 1.32e-07 ***</span></a>
<a class="sourceLine" id="cb218-168" data-line-number="168"><span class="co">#   age.c        -0.9099     0.1569   -5.80  0.00439 ** </span></a>
<a class="sourceLine" id="cb218-169" data-line-number="169"></a>
<a class="sourceLine" id="cb218-170" data-line-number="170"></a>
<a class="sourceLine" id="cb218-171" data-line-number="171"></a>
<a class="sourceLine" id="cb218-172" data-line-number="172"></a>
<a class="sourceLine" id="cb218-173" data-line-number="173"></a>
<a class="sourceLine" id="cb218-174" data-line-number="174"><span class="co"># Some assumptions --------------------------------------------------------</span></a>
<a class="sourceLine" id="cb218-175" data-line-number="175"></a>
<a class="sourceLine" id="cb218-176" data-line-number="176"><span class="co"># Linearity</span></a>
<a class="sourceLine" id="cb218-177" data-line-number="177"><span class="co"># Linear models assume that the relationship between your variables is linear, no way!</span></a>
<a class="sourceLine" id="cb218-178" data-line-number="178"></a>
<a class="sourceLine" id="cb218-179" data-line-number="179"></a>
<a class="sourceLine" id="cb218-180" data-line-number="180"></a>
<a class="sourceLine" id="cb218-181" data-line-number="181"><span class="co">#There are a bunch of tests you can do. Remember these</span></a>
<a class="sourceLine" id="cb218-182" data-line-number="182"></a>
<a class="sourceLine" id="cb218-183" data-line-number="183"><span class="co">#Residuals are how far the data point is from the linear model line.</span></a>
<a class="sourceLine" id="cb218-184" data-line-number="184"></a>
<a class="sourceLine" id="cb218-185" data-line-number="185"><span class="co"># (The red lines indicate the residual values)</span></a>
<a class="sourceLine" id="cb218-186" data-line-number="186"><span class="kw">ggplot</span>(<span class="dt">data =</span> my.df, <span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> pitch)) <span class="op">+</span></a>
<a class="sourceLine" id="cb218-187" data-line-number="187"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">size =</span> <span class="fl">.5</span>, <span class="dt">se =</span> F, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb218-188" data-line-number="188"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> pitch, </a>
<a class="sourceLine" id="cb218-189" data-line-number="189">                    <span class="dt">ymax =</span> pitch <span class="op">-</span><span class="st"> </span><span class="kw">resid</span>(xmdl)), <span class="dt">width =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb218-190" data-line-number="190"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb218-191" data-line-number="191"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y =</span> pitch <span class="op">-</span><span class="st"> </span><span class="kw">resid</span>(xmdl)),<span class="dt">size =</span> <span class="fl">.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb218-192" data-line-number="192"><span class="st">  </span><span class="kw">theme_classic</span>()</a>
<a class="sourceLine" id="cb218-193" data-line-number="193"></a>
<a class="sourceLine" id="cb218-194" data-line-number="194"><span class="kw">resid</span>(xmdl)</a>
<a class="sourceLine" id="cb218-195" data-line-number="195"></a>
<a class="sourceLine" id="cb218-196" data-line-number="196"><span class="kw">plot</span>(<span class="dt">x =</span> <span class="kw">fitted</span>(xmdl),<span class="dt">y =</span> <span class="kw">residuals</span>(xmdl))</a>
<a class="sourceLine" id="cb218-197" data-line-number="197"><span class="kw">abline</span>(<span class="dt">a =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb218-198" data-line-number="198"></a>
<a class="sourceLine" id="cb218-199" data-line-number="199"></a>
<a class="sourceLine" id="cb218-200" data-line-number="200"><span class="co"># Colinearity of independent variables (or predictors)</span></a>
<a class="sourceLine" id="cb218-201" data-line-number="201"></a>
<a class="sourceLine" id="cb218-202" data-line-number="202"><span class="co"># Well, we only have one predictor</span></a>
<a class="sourceLine" id="cb218-203" data-line-number="203"></a>
<a class="sourceLine" id="cb218-204" data-line-number="204"></a>
<a class="sourceLine" id="cb218-205" data-line-number="205"><span class="co"># Heteroskedasticity</span></a>
<a class="sourceLine" id="cb218-206" data-line-number="206"></a>
<a class="sourceLine" id="cb218-207" data-line-number="207"><span class="co"># Approximately equal variances across your sample</span></a>
<a class="sourceLine" id="cb218-208" data-line-number="208"></a>
<a class="sourceLine" id="cb218-209" data-line-number="209"><span class="kw">plot</span>(<span class="kw">rnorm</span>(<span class="dv">100</span>),<span class="kw">rnorm</span>(<span class="dv">100</span>))</a>
<a class="sourceLine" id="cb218-210" data-line-number="210"><span class="kw">abline</span>(<span class="dt">a =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb218-211" data-line-number="211"></a>
<a class="sourceLine" id="cb218-212" data-line-number="212"><span class="co"># Normality of residuals</span></a>
<a class="sourceLine" id="cb218-213" data-line-number="213"></a>
<a class="sourceLine" id="cb218-214" data-line-number="214"><span class="kw">hist</span>(<span class="kw">residuals</span>(xmdl), <span class="dt">breaks =</span> <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb218-215" data-line-number="215"></a>
<a class="sourceLine" id="cb218-216" data-line-number="216"><span class="kw">qqnorm</span>(<span class="kw">residuals</span>(xmdl))</a>
<a class="sourceLine" id="cb218-217" data-line-number="217"><span class="co"># Seen above with...</span></a>
<a class="sourceLine" id="cb218-218" data-line-number="218"><span class="kw">plot</span>(xmdl)</a>
<a class="sourceLine" id="cb218-219" data-line-number="219"></a>
<a class="sourceLine" id="cb218-220" data-line-number="220"></a>
<a class="sourceLine" id="cb218-221" data-line-number="221"><span class="co">#Absence of influential data points...</span></a>
<a class="sourceLine" id="cb218-222" data-line-number="222"><span class="kw">dfbeta</span>(xmdl)</a>
<a class="sourceLine" id="cb218-223" data-line-number="223"><span class="co"># (Intercept)       age.c</span></a>
<a class="sourceLine" id="cb218-224" data-line-number="224"><span class="co"># 1  -0.8002664  0.06437573</span></a>
<a class="sourceLine" id="cb218-225" data-line-number="225"><span class="co"># 2  -0.5220150  0.02736278</span></a>
<a class="sourceLine" id="cb218-226" data-line-number="226"><span class="co"># 3   0.9678744 -0.01456709</span></a>
<a class="sourceLine" id="cb218-227" data-line-number="227"><span class="co"># 4   2.0026352  0.05092767</span></a>
<a class="sourceLine" id="cb218-228" data-line-number="228"><span class="co"># 5  -1.7103247 -0.06479736</span></a>
<a class="sourceLine" id="cb218-229" data-line-number="229"><span class="co"># 6  -0.7828787 -0.06622744</span></a></code></pre></div>
<p>Finally… Independence! Each observation must be independent from the others. We will deal with repeated measures corrections to linear models by including participants as a random effect (among other things).</p>
<p>##Solutions</p>
<p>###Challenge 2
If you look back at the boxplot that we constructed earlier, you can see that the value 202.588 Hz seems to fall halfway between males and females (in the informal condition) – and this is indeed what this intercept represents. It’s the average of our data for the informal condition.</p>
<p>###Challenge 4</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb219-1" data-line-number="1">my.df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb219-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sex =</span> <span class="kw">fct_recode</span>(sex, <span class="st">&quot;0&quot;</span> =<span class="st"> &quot;female&quot;</span>, <span class="st">&quot;1&quot;</span> =<span class="st"> &quot;male&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb219-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sex =</span> <span class="kw">as.numeric</span>(<span class="kw">as.character</span>(sex))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb219-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span> sex,<span class="dt">y=</span>pitch)) <span class="op">+</span></a>
<a class="sourceLine" id="cb219-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb219-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="kw">coef</span>(xmdl)[<span class="dv">1</span>],<span class="dt">slope =</span> <span class="kw">coef</span>(xmdl)[<span class="dv">2</span>]) <span class="op">+</span></a>
<a class="sourceLine" id="cb219-7" data-line-number="7"><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span>.<span class="dv">5</span>,<span class="fl">1.5</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">300</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb219-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="kw">aes</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>), <span class="dt">linetype =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">.7</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb219-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>), <span class="dt">linetype =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">.7</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb219-10" data-line-number="10"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;female&quot;</span>,<span class="st">&quot;male&quot;</span>))</a></code></pre></div>
<p>###Challenge 5</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb220-1" data-line-number="1">my.df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb220-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age,<span class="dt">y =</span> pitch)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb220-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb220-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,<span class="dt">se =</span> F, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="fl">.5</span>)</a></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multilevel-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://spencercastro.com/07_LinearModeling.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
